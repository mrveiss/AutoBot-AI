# AutoBot Development Override
# This file configures the frontend service for robust dependency management

services:
  frontend:
    build:
      context: ./autobot-vue
      dockerfile: ../docker/frontend/Dockerfile.dev  # Use development Dockerfile
      args:
        - NODE_VERSION=${NODE_VERSION:-20}
    image: autobot-frontend:dev
    environment:
      - NODE_ENV=development
      - VITE_BACKEND_HOST=192.168.168.17
      - VITE_BACKEND_PORT=8001
      - DOCKER_CONTAINER=true
      - DEBUG_PROXY=${DEBUG_PROXY:-false}
      - LOG_LEVEL=${FRONTEND_LOG_LEVEL:-info}
      # Force npm to use the volume for node_modules
      - NPM_CONFIG_CACHE=/tmp/.npm
    healthcheck:
      # Give more time for dependency checking in development
      start_period: 90s
      timeout: 15s
    volumes:
      - ./autobot-vue:/app
      - frontend_node_modules:/app/node_modules  # Managed by entrypoint script
      - ./logs:/shared/logs
