{
  "full_results": {
    "total_functions": 1706,
    "duplicate_groups": 136,
    "total_duplicates": 403,
    "lines_that_could_be_saved": 5646,
    "analysis_time_seconds": 3.243542432785034,
    "used_npu": false,
    "duplicate_details": [
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 6,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "__init__",
            "line_range": "127-130",
            "signature": "__init__(self, config)",
            "complexity": 1
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "__init__",
            "line_range": "273-276",
            "signature": "__init__(self, config)",
            "complexity": 1
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "__init__",
            "line_range": "413-416",
            "signature": "__init__(self, config)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 26,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "_create_error_response",
            "line_range": "254-267",
            "signature": "_create_error_response(self, request, error_message)",
            "complexity": 1
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "_create_error_response",
            "line_range": "394-407",
            "signature": "_create_error_response(self, request, error_message)",
            "complexity": 1
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "_create_error_response",
            "line_range": "541-554",
            "signature": "_create_error_response(self, request, error_message)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 2,
        "functions": [
          {
            "file": "src/intelligence/intelligent_agent.py",
            "name": "_get_timestamp",
            "line_range": "674-676",
            "signature": "_get_timestamp(self)",
            "complexity": 1
          },
          {
            "file": "src/intelligence/streaming_executor.py",
            "name": "_get_timestamp",
            "line_range": "455-457",
            "signature": "_get_timestamp(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 25,
        "functions": [
          {
            "file": "src/agents/network_discovery_agent.py",
            "name": "_run_command",
            "line_range": "368-393",
            "signature": "_run_command(self, cmd, timeout)",
            "complexity": 4
          },
          {
            "file": "src/agents/security_scanner_agent.py",
            "name": "_run_command",
            "line_range": "344-369",
            "signature": "_run_command(self, cmd, timeout)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 85,
        "functions": [
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "assess_content_quality",
            "line_range": "453-538",
            "signature": "assess_content_quality(self, content_data)",
            "complexity": 3
          },
          {
            "file": "src/agents/containerized_librarian_assistant.py",
            "name": "assess_content_quality",
            "line_range": "202-287",
            "signature": "assess_content_quality(self, content_data)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 43,
        "functions": [
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "_create_research_summary",
            "line_range": "696-739",
            "signature": "_create_research_summary(self, query, content_list)",
            "complexity": 3
          },
          {
            "file": "src/agents/containerized_librarian_assistant.py",
            "name": "_create_research_summary",
            "line_range": "453-496",
            "signature": "_create_research_summary(self, query, content_list)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Extract to shared utility function",
        "estimated_lines_saved": 6,
        "functions": [
          {
            "file": "src/agents/enhanced_system_commands_agent.py",
            "name": "get_capabilities",
            "line_range": "172-174",
            "signature": "get_capabilities(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/classification_agent.py",
            "name": "get_capabilities",
            "line_range": "102-104",
            "signature": "get_capabilities(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "get_capabilities",
            "line_range": "73-75",
            "signature": "get_capabilities(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "get_capabilities",
            "line_range": "104-106",
            "signature": "get_capabilities(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9076224113769524,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 53,
        "functions": [
          {
            "file": "src/voice_processing_system.py",
            "name": "_determine_required_context",
            "line_range": "980-995",
            "signature": "_determine_required_context(self, command_analysis)",
            "complexity": 5
          },
          {
            "file": "src/project_state_manager.py",
            "name": "generate_validation_report",
            "line_range": "647-677",
            "signature": "generate_validation_report(self)",
            "complexity": 4
          },
          {
            "file": "src/hardware_acceleration.py",
            "name": "get_hardware_recommendations",
            "line_range": "419-471",
            "signature": "get_hardware_recommendations(self)",
            "complexity": 6
          },
          {
            "file": "src/agents/enhanced_system_commands_agent.py",
            "name": "_build_context_string",
            "line_range": "288-305",
            "signature": "_build_context_string(self, context)",
            "complexity": 6
          }
        ]
      },
      {
        "similarity_score": 0.9638859483894391,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/voice_processing_system.py",
            "name": "get_command_history",
            "line_range": "1027-1042",
            "signature": "get_command_history(self, limit)",
            "complexity": 2
          },
          {
            "file": "src/secure_command_executor.py",
            "name": "get_command_history",
            "line_range": "360-362",
            "signature": "get_command_history(self, limit)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9502050440469066,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/voice_processing_system.py",
            "name": "get_system_status",
            "line_range": "1044-1056",
            "signature": "get_system_status(self)",
            "complexity": 1
          },
          {
            "file": "src/context_aware_decision_system.py",
            "name": "get_system_status",
            "line_range": "1216-1228",
            "signature": "get_system_status(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0000000000000002,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 16,
        "functions": [
          {
            "file": "src/gui_controller_dummy.py",
            "name": "_screenshot",
            "line_range": "20-26",
            "signature": "_screenshot(self, region)",
            "complexity": 1
          },
          {
            "file": "src/gui_controller_dummy.py",
            "name": "click_element",
            "line_range": "28-38",
            "signature": "click_element(self, image_path, confidence, button, clicks, interval)",
            "complexity": 1
          },
          {
            "file": "src/gui_controller_dummy.py",
            "name": "read_text_from_region",
            "line_range": "40-52",
            "signature": "read_text_from_region(self, x, y, width, height)",
            "complexity": 1
          },
          {
            "file": "src/gui_controller_dummy.py",
            "name": "move_mouse",
            "line_range": "62-68",
            "signature": "move_mouse(self, x, y, duration)",
            "complexity": 1
          },
          {
            "file": "src/gui_controller_dummy.py",
            "name": "bring_window_to_front",
            "line_range": "70-76",
            "signature": "bring_window_to_front(self, app_title)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9583398210517805,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 304,
        "functions": [
          {
            "file": "src/code_analyzer.py",
            "name": "main",
            "line_range": "544-579",
            "signature": "main()",
            "complexity": 4
          },
          {
            "file": "src/voice_interface.py",
            "name": "test_voice_interface",
            "line_range": "225-243",
            "signature": "test_voice_interface()",
            "complexity": 1
          },
          {
            "file": "src/command_executor.py",
            "name": "main",
            "line_range": "23-39",
            "signature": "main()",
            "complexity": 1
          },
          {
            "file": "src/gui_controller.py",
            "name": "start_virtual_display",
            "line_range": "33-50",
            "signature": "start_virtual_display(self)",
            "complexity": 3
          },
          {
            "file": "src/secure_command_executor.py",
            "name": "example_approval_callback",
            "line_range": "371-385",
            "signature": "example_approval_callback(approval_data)",
            "complexity": 2
          },
          {
            "file": "src/secure_command_executor.py",
            "name": "test_commands",
            "line_range": "387-422",
            "signature": "test_commands()",
            "complexity": 4
          },
          {
            "file": "src/intelligence/os_detector.py",
            "name": "test_detector",
            "line_range": "542-582",
            "signature": "test_detector()",
            "complexity": 5
          },
          {
            "file": "src/intelligence/intelligent_agent.py",
            "name": "test_agent",
            "line_range": "809-846",
            "signature": "test_agent()",
            "complexity": 3
          },
          {
            "file": "src/intelligence/goal_processor.py",
            "name": "test_processor",
            "line_range": "487-531",
            "signature": "test_processor()",
            "complexity": 5
          },
          {
            "file": "src/intelligence/streaming_executor.py",
            "name": "test_executor",
            "line_range": "561-603",
            "signature": "test_executor()",
            "complexity": 4
          },
          {
            "file": "src/agents/research_agent.py",
            "name": "test_research",
            "line_range": "319-348",
            "signature": "test_research()",
            "complexity": 1
          },
          {
            "file": "src/agents/classification_agent.py",
            "name": "main",
            "line_range": "446-490",
            "signature": "main()",
            "complexity": 9
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "demo_intelligent_workflow",
            "line_range": "1203-1216",
            "signature": "demo_intelligent_workflow()",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9725133098183614,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 7,
        "functions": [
          {
            "file": "src/code_analyzer.py",
            "name": "__init__",
            "line_range": "56-75",
            "signature": "__init__(self, redis_client, use_npu)",
            "complexity": 2
          },
          {
            "file": "src/workflow_classifier.py",
            "name": "__init__",
            "line_range": "22-32",
            "signature": "__init__(self, redis_client)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9550014882138289,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 38,
        "functions": [
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_collect_visual_context",
            "line_range": "195-249",
            "signature": "_collect_visual_context(self)",
            "complexity": 5
          },
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_collect_audio_context",
            "line_range": "251-292",
            "signature": "_collect_audio_context(self)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9301879997151618,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 23,
        "functions": [
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_collect_system_context",
            "line_range": "294-356",
            "signature": "_collect_system_context(self)",
            "complexity": 4
          },
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_collect_historical_context",
            "line_range": "358-384",
            "signature": "_collect_historical_context(self, decision_type)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.882475041927752,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 470,
        "functions": [
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_identify_available_actions",
            "line_range": "463-529",
            "signature": "_identify_available_actions(self, decision_type, context_elements)",
            "complexity": 9
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "store_tool_knowledge",
            "line_range": "109-202",
            "signature": "store_tool_knowledge(self, tool_info)",
            "complexity": 1
          },
          {
            "file": "src/agents/classification_agent.py",
            "name": "_combine_classifications",
            "line_range": "259-315",
            "signature": "_combine_classifications(self, llm_result, keyword_result, user_message)",
            "complexity": 6
          },
          {
            "file": "src/llm_providers/vllm_provider.py",
            "name": "_create_sampling_params",
            "line_range": "184-203",
            "signature": "_create_sampling_params(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/websockets.py",
            "name": "websocket_endpoint",
            "line_range": "20-169",
            "signature": "websocket_endpoint(websocket)",
            "complexity": 34
          },
          {
            "file": "backend/api/websockets.py",
            "name": "broadcast_event",
            "line_range": "37-143",
            "signature": "broadcast_event(event_data)",
            "complexity": 29
          },
          {
            "file": "backend/api/knowledge.py",
            "name": "get_system_documentation",
            "line_range": "777-846",
            "signature": "get_system_documentation()",
            "complexity": 10
          },
          {
            "file": "backend/api/knowledge.py",
            "name": "get_system_prompts",
            "line_range": "850-920",
            "signature": "get_system_prompts()",
            "complexity": 10
          },
          {
            "file": "backend/api/monitoring.py",
            "name": "get_health_summary",
            "line_range": "317-332",
            "signature": "get_health_summary()",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9335381418588076,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 30,
        "functions": [
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_assess_risk_factors",
            "line_range": "531-570",
            "signature": "_assess_risk_factors(self, context_elements)",
            "complexity": 5
          },
          {
            "file": "src/computer_vision_system.py",
            "name": "_generate_recommendations",
            "line_range": "696-729",
            "signature": "_generate_recommendations(self, screen_state)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9371787954179274,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 22,
        "functions": [
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_create_no_action_decision",
            "line_range": "946-971",
            "signature": "_create_no_action_decision(self, context, reason)",
            "complexity": 1
          },
          {
            "file": "src/context_aware_decision_system.py",
            "name": "_create_placeholder_decision",
            "line_range": "973-998",
            "signature": "_create_placeholder_decision(self, context, reason)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9857376035566991,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 6,
        "functions": [
          {
            "file": "src/workflow_templates.py",
            "name": "__post_init__",
            "line_range": "38-42",
            "signature": "__post_init__(self)",
            "complexity": 3
          },
          {
            "file": "src/workflow_templates.py",
            "name": "__post_init__",
            "line_range": "60-62",
            "signature": "__post_init__(self)",
            "complexity": 2
          },
          {
            "file": "src/workflow_scheduler.py",
            "name": "__post_init__",
            "line_range": "66-74",
            "signature": "__post_init__(self)",
            "complexity": 5
          },
          {
            "file": "src/intelligence/intelligent_agent.py",
            "name": "__post_init__",
            "line_range": "43-48",
            "signature": "__post_init__(self)",
            "complexity": 3
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "__post_init__",
            "line_range": "113-119",
            "signature": "__post_init__(self)",
            "complexity": 4
          },
          {
            "file": "backend/api/workflow_automation.py",
            "name": "__post_init__",
            "line_range": "106-110",
            "signature": "__post_init__(self)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9815139629867556,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 1002,
        "functions": [
          {
            "file": "src/workflow_templates.py",
            "name": "_add_network_security_scan_template",
            "line_range": "99-194",
            "signature": "_add_network_security_scan_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_vulnerability_assessment_template",
            "line_range": "196-255",
            "signature": "_add_vulnerability_assessment_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_security_audit_template",
            "line_range": "257-341",
            "signature": "_add_security_audit_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_comprehensive_research_template",
            "line_range": "343-400",
            "signature": "_add_comprehensive_research_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_competitive_analysis_template",
            "line_range": "402-468",
            "signature": "_add_competitive_analysis_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_technology_research_template",
            "line_range": "470-541",
            "signature": "_add_technology_research_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_system_health_check_template",
            "line_range": "543-617",
            "signature": "_add_system_health_check_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_performance_optimization_template",
            "line_range": "619-699",
            "signature": "_add_performance_optimization_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_backup_and_recovery_template",
            "line_range": "701-773",
            "signature": "_add_backup_and_recovery_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_code_review_template",
            "line_range": "775-847",
            "signature": "_add_code_review_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_deployment_pipeline_template",
            "line_range": "849-922",
            "signature": "_add_deployment_pipeline_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_testing_strategy_template",
            "line_range": "924-995",
            "signature": "_add_testing_strategy_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_data_analysis_template",
            "line_range": "997-1076",
            "signature": "_add_data_analysis_template(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_templates.py",
            "name": "_add_log_analysis_template",
            "line_range": "1078-1159",
            "signature": "_add_log_analysis_template(self)",
            "complexity": 1
          },
          {
            "file": "src/orchestrator.py",
            "name": "plan_workflow_steps",
            "line_range": "1222-1428",
            "signature": "plan_workflow_steps(self, user_message, complexity)",
            "complexity": 6
          },
          {
            "file": "backend/api/workflow_automation.py",
            "name": "_create_system_update_workflow",
            "line_range": "521-528",
            "signature": "_create_system_update_workflow(self, session_id)",
            "complexity": 1
          },
          {
            "file": "backend/api/workflow_automation.py",
            "name": "_create_dev_environment_workflow",
            "line_range": "530-539",
            "signature": "_create_dev_environment_workflow(self, session_id)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 41,
        "functions": [
          {
            "file": "src/retry_mechanism.py",
            "name": "retry_async",
            "line_range": "290-334",
            "signature": "retry_async(max_attempts, base_delay, max_delay, backoff_multiplier, strategy, retryable_exceptions, operation_name)",
            "complexity": 3
          },
          {
            "file": "src/retry_mechanism.py",
            "name": "retry_sync",
            "line_range": "337-381",
            "signature": "retry_sync(max_attempts, base_delay, max_delay, backoff_multiplier, strategy, retryable_exceptions, operation_name)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 1.0000000000000002,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 15,
        "functions": [
          {
            "file": "src/retry_mechanism.py",
            "name": "retry_database_operation",
            "line_range": "385-403",
            "signature": "retry_database_operation(func)",
            "complexity": 1
          },
          {
            "file": "src/retry_mechanism.py",
            "name": "retry_network_operation",
            "line_range": "406-425",
            "signature": "retry_network_operation(func)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.984170290818337,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 69,
        "functions": [
          {
            "file": "src/retry_mechanism.py",
            "name": "execute_async",
            "line_range": "115-190",
            "signature": "execute_async(self, func)",
            "complexity": 11
          },
          {
            "file": "src/retry_mechanism.py",
            "name": "execute_sync",
            "line_range": "192-264",
            "signature": "execute_sync(self, func)",
            "complexity": 10
          }
        ]
      },
      {
        "similarity_score": 0.9800719691810139,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 63,
        "functions": [
          {
            "file": "src/retry_mechanism.py",
            "name": "decorator",
            "line_range": "311-333",
            "signature": "decorator(func)",
            "complexity": 3
          },
          {
            "file": "src/retry_mechanism.py",
            "name": "decorator",
            "line_range": "358-380",
            "signature": "decorator(func)",
            "complexity": 3
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "decorator",
            "line_range": "449-467",
            "signature": "decorator(func)",
            "complexity": 2
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "decorator",
            "line_range": "491-509",
            "signature": "decorator(func)",
            "complexity": 2
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "decorator",
            "line_range": "727-744",
            "signature": "decorator(func)",
            "complexity": 2
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "decorator",
            "line_range": "214-217",
            "signature": "decorator(func)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9051388169518195,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/retry_mechanism.py",
            "name": "example_usage",
            "line_range": "452-491",
            "signature": "example_usage()",
            "complexity": 5
          },
          {
            "file": "src/event_manager.py",
            "name": "test_listener",
            "line_range": "96-97",
            "signature": "test_listener(event)",
            "complexity": 1
          },
          {
            "file": "src/event_manager.py",
            "name": "mock_websocket_broadcast",
            "line_range": "104-105",
            "signature": "mock_websocket_broadcast(event)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 11,
        "functions": [
          {
            "file": "src/retry_mechanism.py",
            "name": "wrapper",
            "line_range": "313-331",
            "signature": "wrapper()",
            "complexity": 3
          },
          {
            "file": "src/retry_mechanism.py",
            "name": "wrapper",
            "line_range": "360-378",
            "signature": "wrapper()",
            "complexity": 3
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "wrapper",
            "line_range": "463-464",
            "signature": "wrapper()",
            "complexity": 1
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "wrapper",
            "line_range": "505-506",
            "signature": "wrapper()",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9686440146845595,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 190,
        "functions": [
          {
            "file": "src/markdown_reference_system.py",
            "name": "_init_markdown_tables",
            "line_range": "42-107",
            "signature": "_init_markdown_tables(self)",
            "complexity": 1
          },
          {
            "file": "src/enhanced_memory_manager.py",
            "name": "_init_database",
            "line_range": "74-150",
            "signature": "_init_database(self)",
            "complexity": 1
          },
          {
            "file": "src/project_state_manager.py",
            "name": "_init_database",
            "line_range": "101-159",
            "signature": "_init_database(self)",
            "complexity": 1
          },
          {
            "file": "src/memory_manager.py",
            "name": "_init_memory_db",
            "line_range": "73-202",
            "signature": "_init_memory_db(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9322812682475212,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/markdown_reference_system.py",
            "name": "_resolve_markdown_reference",
            "line_range": "349-367",
            "signature": "_resolve_markdown_reference(self, reference, source_file, all_files)",
            "complexity": 5
          },
          {
            "file": "backend/app_factory.py",
            "name": "handle_options",
            "line_range": "515-516",
            "signature": "handle_options(path)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9550612777996776,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 8,
        "functions": [
          {
            "file": "src/prompt_manager.py",
            "name": "get_prompt",
            "line_range": "286-297",
            "signature": "get_prompt(prompt_key)",
            "complexity": 1
          },
          {
            "file": "src/prompt_manager.py",
            "name": "get_raw",
            "line_range": "175-191",
            "signature": "get_raw(self, prompt_key)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9624804243088815,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 13,
        "functions": [
          {
            "file": "src/prompt_manager.py",
            "name": "__init__",
            "line_range": "31-42",
            "signature": "__init__(self, prompts_dir)",
            "complexity": 1
          },
          {
            "file": "src/config.py",
            "name": "__init__",
            "line_range": "70-78",
            "signature": "__init__(self, config_dir)",
            "complexity": 1
          },
          {
            "file": "src/secure_command_executor.py",
            "name": "__init__",
            "line_range": "31-93",
            "signature": "__init__(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9692493375637135,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 12,
        "functions": [
          {
            "file": "src/config.py",
            "name": "_filtered_yaml_dump",
            "line_range": "23-38",
            "signature": "_filtered_yaml_dump(data, stream)",
            "complexity": 6
          },
          {
            "file": "src/config.py",
            "name": "_filtered_yaml_safe_dump",
            "line_range": "41-56",
            "signature": "_filtered_yaml_safe_dump(data, stream)",
            "complexity": 6
          }
        ]
      },
      {
        "similarity_score": 0.9259619092339502,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/config.py",
            "name": "get_redis_config",
            "line_range": "790-792",
            "signature": "get_redis_config()",
            "complexity": 1
          },
          {
            "file": "backend/models/settings.py",
            "name": "get_redis_config",
            "line_range": "263-271",
            "signature": "get_redis_config(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.993130842707742,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/config.py",
            "name": "reload_config",
            "line_range": "800-802",
            "signature": "reload_config()",
            "complexity": 1
          },
          {
            "file": "src/config.py",
            "name": "reload",
            "line_range": "347-349",
            "signature": "reload(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9400337267822922,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 13,
        "functions": [
          {
            "file": "src/config.py",
            "name": "get_llm_config",
            "line_range": "355-454",
            "signature": "get_llm_config(self)",
            "complexity": 3
          },
          {
            "file": "src/config.py",
            "name": "get_backend_config",
            "line_range": "656-672",
            "signature": "get_backend_config(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9428177339085886,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 8,
        "functions": [
          {
            "file": "src/config.py",
            "name": "update_llm_model",
            "line_range": "674-685",
            "signature": "update_llm_model(self, model_name)",
            "complexity": 1
          },
          {
            "file": "src/config.py",
            "name": "update_embedding_model",
            "line_range": "754-769",
            "signature": "update_embedding_model(self, model_name)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9285679137948015,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/llm_interface_extended.py",
            "name": "__init__",
            "line_range": "22-37",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/intelligence/os_detector.py",
            "name": "__init__",
            "line_range": "67-70",
            "signature": "__init__(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 5,
        "functions": [
          {
            "file": "src/llm_interface_extended.py",
            "name": "_handle_ollama_request",
            "line_range": "173-181",
            "signature": "_handle_ollama_request(self, messages, model_name)",
            "complexity": 1
          },
          {
            "file": "src/llm_interface_extended.py",
            "name": "_handle_openai_request",
            "line_range": "183-191",
            "signature": "_handle_openai_request(self, messages, model_name)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.943672470800315,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 3,
        "functions": [
          {
            "file": "src/llm_interface_extended.py",
            "name": "cleanup",
            "line_range": "275-281",
            "signature": "cleanup(self)",
            "complexity": 2
          },
          {
            "file": "src/agents/agent_client.py",
            "name": "cleanup",
            "line_range": "202-205",
            "signature": "cleanup(self)",
            "complexity": 2
          },
          {
            "file": "src/llm_providers/vllm_provider.py",
            "name": "cleanup",
            "line_range": "220-230",
            "signature": "cleanup(self)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9035350095652408,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 215,
        "functions": [
          {
            "file": "src/diagnostics.py",
            "name": "__init__",
            "line_range": "17-55",
            "signature": "__init__(self)",
            "complexity": 3
          },
          {
            "file": "src/llm_interface.py",
            "name": "__init__",
            "line_range": "79-170",
            "signature": "__init__(self)",
            "complexity": 4
          },
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "__init__",
            "line_range": "35-83",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/kb_librarian_agent.py",
            "name": "__init__",
            "line_range": "20-32",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/containerized_librarian_assistant.py",
            "name": "__init__",
            "line_range": "25-66",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "backend/services/config_service.py",
            "name": "get_full_config",
            "line_range": "20-214",
            "signature": "get_full_config()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/diagnostics.py",
            "name": "log_success",
            "line_range": "94-99",
            "signature": "log_success(self, task_info)",
            "complexity": 2
          },
          {
            "file": "backend/app_factory.py",
            "name": "hello_world",
            "line_range": "506-507",
            "signature": "hello_world()",
            "complexity": 1
          },
          {
            "file": "backend/app_factory.py",
            "name": "get_version",
            "line_range": "510-511",
            "signature": "get_version()",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9509512932765155,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 42,
        "functions": [
          {
            "file": "src/diagnostics.py",
            "name": "request_user_permission",
            "line_range": "173-218",
            "signature": "request_user_permission(self, report)",
            "complexity": 3
          },
          {
            "file": "src/orchestrator.py",
            "name": "_handle_command_approval",
            "line_range": "1115-1171",
            "signature": "_handle_command_approval(self, result)",
            "complexity": 6
          }
        ]
      },
      {
        "similarity_score": 0.9306610731868434,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 2,
        "functions": [
          {
            "file": "src/diagnostics.py",
            "name": "set_user_permission",
            "line_range": "220-225",
            "signature": "set_user_permission(self, task_id, granted)",
            "complexity": 2
          },
          {
            "file": "backend/api/chat_knowledge.py",
            "name": "demo",
            "line_range": "678-706",
            "signature": "demo()",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9565046531922459,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 17,
        "functions": [
          {
            "file": "src/workflow_scheduler.py",
            "name": "to_dict",
            "line_range": "76-84",
            "signature": "to_dict(self)",
            "complexity": 1
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "to_dict",
            "line_range": "74-82",
            "signature": "to_dict(self)",
            "complexity": 3
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "to_dict",
            "line_range": "121-131",
            "signature": "to_dict(self)",
            "complexity": 4
          },
          {
            "file": "src/agents/base_agent.py",
            "name": "to_dict",
            "line_range": "83-95",
            "signature": "to_dict(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9947153269517157,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/workflow_scheduler.py",
            "name": "from_dict",
            "line_range": "87-94",
            "signature": "from_dict(cls, data)",
            "complexity": 1
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "from_dict",
            "line_range": "85-93",
            "signature": "from_dict(cls, data)",
            "complexity": 6
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "from_dict",
            "line_range": "134-144",
            "signature": "from_dict(cls, data)",
            "complexity": 7
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/workflow_scheduler.py",
            "name": "pause_queue",
            "line_range": "177-179",
            "signature": "pause_queue(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_scheduler.py",
            "name": "resume_queue",
            "line_range": "181-183",
            "signature": "resume_queue(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9266938369909724,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/workflow_scheduler.py",
            "name": "list_queued",
            "line_range": "195-200",
            "signature": "list_queued(self)",
            "complexity": 1
          },
          {
            "file": "src/workflow_scheduler.py",
            "name": "list_running",
            "line_range": "202-204",
            "signature": "list_running(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9320768162004779,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/workflow_scheduler.py",
            "name": "start",
            "line_range": "267-273",
            "signature": "start(self)",
            "complexity": 2
          },
          {
            "file": "src/worker_node.py",
            "name": "start",
            "line_range": "645-648",
            "signature": "start(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9869132498479736,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 23,
        "functions": [
          {
            "file": "src/computer_vision_system.py",
            "name": "_identify_change_regions",
            "line_range": "389-415",
            "signature": "_identify_change_regions(self, diff_image)",
            "complexity": 4
          },
          {
            "file": "src/multimodal_processor.py",
            "name": "_detect_ui_elements",
            "line_range": "117-154",
            "signature": "_detect_ui_elements(self, cv_image)",
            "complexity": 5
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 7,
        "functions": [
          {
            "file": "src/computer_vision_system.py",
            "name": "_matches_button_criteria",
            "line_range": "471-481",
            "signature": "_matches_button_criteria(self, aspect_ratio, area, region)",
            "complexity": 3
          },
          {
            "file": "src/computer_vision_system.py",
            "name": "_matches_checkbox_criteria",
            "line_range": "495-505",
            "signature": "_matches_checkbox_criteria(self, aspect_ratio, area, region)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9180402906729143,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 24,
        "functions": [
          {
            "file": "src/security_layer.py",
            "name": "__init__",
            "line_range": "13-29",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/enhanced_security_layer.py",
            "name": "__init__",
            "line_range": "24-55",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/agent_client.py",
            "name": "__init__",
            "line_range": "26-40",
            "signature": "__init__(self, config_dict)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9060298117175939,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 106,
        "functions": [
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_execute_system_command",
            "line_range": "312-323",
            "signature": "_execute_system_command(self, command)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_query_system_information",
            "line_range": "325-336",
            "signature": "_query_system_information(self, input_text)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_list_system_services",
            "line_range": "338-347",
            "signature": "_list_system_services(self, input_text)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_manage_service",
            "line_range": "349-367",
            "signature": "_manage_service(self, service_action)",
            "complexity": 3
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_get_process_info",
            "line_range": "369-383",
            "signature": "_get_process_info(self, process_input)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_terminate_process",
            "line_range": "385-394",
            "signature": "_terminate_process(self, pid)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_web_fetch",
            "line_range": "396-405",
            "signature": "_web_fetch(self, url)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_search_knowledge_base",
            "line_range": "407-418",
            "signature": "_search_knowledge_base(self, query)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_store_fact",
            "line_range": "440-451",
            "signature": "_store_fact(self, fact_content)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_type_text",
            "line_range": "473-482",
            "signature": "_type_text(self, text)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_click_element",
            "line_range": "484-495",
            "signature": "_click_element(self, image_path)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_bring_window_to_front",
            "line_range": "497-508",
            "signature": "_bring_window_to_front(self, window_title)",
            "complexity": 2
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_ask_user_for_manual",
            "line_range": "510-528",
            "signature": "_ask_user_for_manual(self, program_question)",
            "complexity": 3
          },
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "_respond_conversationally",
            "line_range": "530-541",
            "signature": "_respond_conversationally(self, response_text)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 1.0000000000000002,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/langchain_agent_orchestrator.py",
            "name": "get_available_tools",
            "line_range": "608-610",
            "signature": "get_available_tools(self)",
            "complexity": 1
          },
          {
            "file": "src/tools/tool_registry.py",
            "name": "get_available_tools",
            "line_range": "525-544",
            "signature": "get_available_tools(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9032917010312176,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 39,
        "functions": [
          {
            "file": "src/enhanced_orchestrator.py",
            "name": "__init__",
            "line_range": "99-126",
            "signature": "__init__(self, base_orchestrator)",
            "complexity": 2
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "__init__",
            "line_range": "111-133",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/chat_knowledge.py",
            "name": "__init__",
            "line_range": "77-91",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/workflow_automation.py",
            "name": "__init__",
            "line_range": "116-128",
            "signature": "__init__(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9257249592341312,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 11,
        "functions": [
          {
            "file": "src/enhanced_orchestrator.py",
            "name": "_check_step_dependencies",
            "line_range": "488-502",
            "signature": "_check_step_dependencies(self, step, completed_results)",
            "complexity": 5
          },
          {
            "file": "backend/api/workflow_automation.py",
            "name": "_check_step_dependencies",
            "line_range": "423-441",
            "signature": "_check_step_dependencies(self, workflow_id, step)",
            "complexity": 7
          }
        ]
      },
      {
        "similarity_score": 0.9612863692475602,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/gui_controller_dummy.py",
            "name": "__init__",
            "line_range": "13-18",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/system_integration.py",
            "name": "__init__",
            "line_range": "14-16",
            "signature": "__init__(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9333056838470692,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 96,
        "functions": [
          {
            "file": "src/orchestrator.py",
            "name": "_listen_for_worker_capabilities",
            "line_range": "147-246",
            "signature": "_listen_for_worker_capabilities(self)",
            "complexity": 11
          },
          {
            "file": "src/orchestrator.py",
            "name": "startup",
            "line_range": "303-425",
            "signature": "startup(self)",
            "complexity": 14
          }
        ]
      },
      {
        "similarity_score": 0.9588751604058502,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 4,
        "functions": [
          {
            "file": "src/orchestrator.py",
            "name": "pause_agent",
            "line_range": "436-441",
            "signature": "pause_agent(self)",
            "complexity": 1
          },
          {
            "file": "src/orchestrator.py",
            "name": "resume_agent",
            "line_range": "443-448",
            "signature": "resume_agent(self)",
            "complexity": 1
          },
          {
            "file": "src/worker_node.py",
            "name": "report_capabilities",
            "line_range": "173-181",
            "signature": "report_capabilities(self)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9582023861766457,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/event_manager.py",
            "name": "_is_debug_mode",
            "line_range": "40-41",
            "signature": "_is_debug_mode(self)",
            "complexity": 1
          },
          {
            "file": "src/tools/tool_registry.py",
            "name": "execute_tool",
            "line_range": "436-523",
            "signature": "execute_tool(self, tool_name, tool_args)",
            "complexity": 17
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/multimodal_processor.py",
            "name": "_process_audio",
            "line_range": "470-472",
            "signature": "_process_audio(self, modal_input)",
            "complexity": 1
          },
          {
            "file": "src/multimodal_processor.py",
            "name": "_process_video",
            "line_range": "490-502",
            "signature": "_process_video(self, modal_input)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9350626067810802,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 1,
        "functions": [
          {
            "file": "src/enhanced_memory_manager.py",
            "name": "__init__",
            "line_range": "68-72",
            "signature": "__init__(self, db_path)",
            "complexity": 1
          },
          {
            "file": "src/agents/system_knowledge_manager.py",
            "name": "__init__",
            "line_range": "24-35",
            "signature": "__init__(self, knowledge_base)",
            "complexity": 1
          },
          {
            "file": "backend/chat_api.py",
            "name": "__init__",
            "line_range": "34-37",
            "signature": "__init__(self, chat_data_dir)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9736681440727776,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 8,
        "functions": [
          {
            "file": "src/llm_interface.py",
            "name": "_resolve_includes",
            "line_range": "183-197",
            "signature": "_resolve_includes(self, content, base_path)",
            "complexity": 2
          },
          {
            "file": "src/llm_interface.py",
            "name": "replace_include",
            "line_range": "184-195",
            "signature": "replace_include(match)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/llm_interface.py",
            "name": "make_request",
            "line_range": "218-221",
            "signature": "make_request()",
            "complexity": 1
          },
          {
            "file": "src/llm_interface.py",
            "name": "make_llm_request",
            "line_range": "477-480",
            "signature": "make_llm_request()",
            "complexity": 1
          },
          {
            "file": "src/llm_interface.py",
            "name": "make_openai_request",
            "line_range": "549-552",
            "signature": "make_openai_request()",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9234508894197422,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 6,
        "functions": [
          {
            "file": "src/hardware_acceleration.py",
            "name": "get_hardware_acceleration_manager",
            "line_range": "581-586",
            "signature": "get_hardware_acceleration_manager()",
            "complexity": 2
          },
          {
            "file": "src/agents/knowledge_retrieval_agent.py",
            "name": "get_knowledge_retrieval_agent",
            "line_range": "457-462",
            "signature": "get_knowledge_retrieval_agent()",
            "complexity": 2
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "get_chat_agent",
            "line_range": "282-287",
            "signature": "get_chat_agent()",
            "complexity": 2
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "get_rag_agent",
            "line_range": "513-518",
            "signature": "get_rag_agent()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9499314443428681,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 49,
        "functions": [
          {
            "file": "src/hardware_acceleration.py",
            "name": "get_device_status",
            "line_range": "518-574",
            "signature": "get_device_status(self)",
            "complexity": 8
          },
          {
            "file": "backend/api/monitoring.py",
            "name": "get_gpu_status",
            "line_range": "51-103",
            "signature": "get_gpu_status(self)",
            "complexity": 7
          }
        ]
      },
      {
        "similarity_score": 0.9999999999999999,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 36,
        "functions": [
          {
            "file": "src/circuit_breaker.py",
            "name": "circuit_breaker_async",
            "line_range": "430-469",
            "signature": "circuit_breaker_async(service_name, failure_threshold, recovery_timeout, success_threshold, timeout, monitored_exceptions)",
            "complexity": 2
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "circuit_breaker_sync",
            "line_range": "472-511",
            "signature": "circuit_breaker_sync(service_name, failure_threshold, recovery_timeout, success_threshold, timeout, monitored_exceptions)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9213510711951084,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 14,
        "functions": [
          {
            "file": "src/circuit_breaker.py",
            "name": "protected_llm_call",
            "line_range": "515-525",
            "signature": "protected_llm_call(func)",
            "complexity": 1
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "protected_database_call",
            "line_range": "528-539",
            "signature": "protected_database_call(func)",
            "complexity": 1
          },
          {
            "file": "src/circuit_breaker.py",
            "name": "protected_network_call",
            "line_range": "542-552",
            "signature": "protected_network_call(func)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.948714444979904,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 3,
        "functions": [
          {
            "file": "src/secure_command_executor.py",
            "name": "_check_dangerous_patterns",
            "line_range": "134-140",
            "signature": "_check_dangerous_patterns(self, command)",
            "complexity": 3
          },
          {
            "file": "src/utils/command_validator.py",
            "name": "_check_dangerous_patterns",
            "line_range": "329-337",
            "signature": "_check_dangerous_patterns(self, command)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9285580786916824,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "generate_text",
            "line_range": "99-101",
            "signature": "generate_text(self, request)",
            "complexity": 1
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "generate_text",
            "line_range": "563-576",
            "signature": "generate_text(self, request)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9301894507568242,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 5,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "_check_rate_limit",
            "line_range": "113-121",
            "signature": "_check_rate_limit(self)",
            "complexity": 2
          },
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "_respect_rate_limit",
            "line_range": "793-806",
            "signature": "_respect_rate_limit(self, domain)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9696009070851969,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 18,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "_initialize_client",
            "line_range": "132-144",
            "signature": "_initialize_client(self)",
            "complexity": 3
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "_initialize_client",
            "line_range": "278-290",
            "signature": "_initialize_client(self)",
            "complexity": 3
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "_initialize_client",
            "line_range": "418-431",
            "signature": "_initialize_client(self)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9697329024355352,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 100,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "analyze_image",
            "line_range": "189-245",
            "signature": "analyze_image(self, request)",
            "complexity": 8
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "analyze_image",
            "line_range": "332-385",
            "signature": "analyze_image(self, request)",
            "complexity": 7
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "analyze_image",
            "line_range": "479-532",
            "signature": "analyze_image(self, request)",
            "complexity": 7
          }
        ]
      },
      {
        "similarity_score": 0.9766872293832127,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 6,
        "functions": [
          {
            "file": "src/modern_ai_integration.py",
            "name": "multimodal_chat",
            "line_range": "247-252",
            "signature": "multimodal_chat(self, request)",
            "complexity": 2
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "multimodal_chat",
            "line_range": "387-392",
            "signature": "multimodal_chat(self, request)",
            "complexity": 2
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "multimodal_chat",
            "line_range": "534-539",
            "signature": "multimodal_chat(self, request)",
            "complexity": 2
          },
          {
            "file": "src/modern_ai_integration.py",
            "name": "multimodal_chat",
            "line_range": "593-598",
            "signature": "multimodal_chat(self, request)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9419036860605794,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 262,
        "functions": [
          {
            "file": "src/intelligence/intelligent_agent.py",
            "name": "process_natural_language_goal",
            "line_range": "171-405",
            "signature": "process_natural_language_goal(self, user_input, context)",
            "complexity": 15
          },
          {
            "file": "src/intelligence/intelligent_agent.py",
            "name": "_handle_complex_goal",
            "line_range": "407-499",
            "signature": "_handle_complex_goal(self, user_input)",
            "complexity": 7
          },
          {
            "file": "src/intelligence/streaming_executor.py",
            "name": "execute_with_streaming",
            "line_range": "86-262",
            "signature": "execute_with_streaming(self, command, user_goal, timeout, provide_commentary)",
            "complexity": 12
          }
        ]
      },
      {
        "similarity_score": 0.9363701190451064,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/intelligence/intelligent_agent.py",
            "name": "kill_process",
            "line_range": "730-742",
            "signature": "kill_process(self, process_id)",
            "complexity": 2
          },
          {
            "file": "src/intelligence/streaming_executor.py",
            "name": "kill_process",
            "line_range": "472-502",
            "signature": "kill_process(self, process_id)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9503315780809051,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 22,
        "functions": [
          {
            "file": "src/intelligence/streaming_executor.py",
            "name": "read_stdout",
            "line_range": "276-312",
            "signature": "read_stdout()",
            "complexity": 8
          },
          {
            "file": "src/intelligence/streaming_executor.py",
            "name": "read_stderr",
            "line_range": "314-339",
            "signature": "read_stderr()",
            "complexity": 6
          }
        ]
      },
      {
        "similarity_score": 0.9335760761412761,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 21,
        "functions": [
          {
            "file": "src/metrics/system_monitor.py",
            "name": "get_resource_summary",
            "line_range": "180-271",
            "signature": "get_resource_summary(self, minutes)",
            "complexity": 10
          },
          {
            "file": "src/metrics/workflow_metrics.py",
            "name": "_aggregate_resource_usage",
            "line_range": "346-370",
            "signature": "_aggregate_resource_usage(self, snapshots)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9666287251994061,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 10,
        "functions": [
          {
            "file": "src/utils/task_queue.py",
            "name": "task",
            "line_range": "718-746",
            "signature": "task(name)",
            "complexity": 2
          },
          {
            "file": "src/utils/task_queue.py",
            "name": "task",
            "line_range": "206-219",
            "signature": "task(self, name)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9355826194151526,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 12,
        "functions": [
          {
            "file": "src/utils/redis_client.py",
            "name": "get_redis_config",
            "line_range": "96-113",
            "signature": "get_redis_config()",
            "complexity": 4
          },
          {
            "file": "backend/services/config_service.py",
            "name": "get_redis_config",
            "line_range": "227-242",
            "signature": "get_redis_config()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.8967403954555829,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 31,
        "functions": [
          {
            "file": "src/tools/tool_registry.py",
            "name": "query_system_information",
            "line_range": "91-103",
            "signature": "query_system_information(self)",
            "complexity": 1
          },
          {
            "file": "src/tools/tool_registry.py",
            "name": "list_system_services",
            "line_range": "105-115",
            "signature": "list_system_services(self)",
            "complexity": 1
          },
          {
            "file": "src/tools/tool_registry.py",
            "name": "get_process_info",
            "line_range": "134-152",
            "signature": "get_process_info(self, process_name, pid)",
            "complexity": 3
          },
          {
            "file": "src/tools/tool_registry.py",
            "name": "ask_user_for_manual",
            "line_range": "399-418",
            "signature": "ask_user_for_manual(self, program_name, question_text)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9471779248934613,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/tools/tool_registry.py",
            "name": "bring_window_to_front",
            "line_range": "381-395",
            "signature": "bring_window_to_front(self, window_title)",
            "complexity": 1
          },
          {
            "file": "src/tools/tool_registry.py",
            "name": "respond_conversationally",
            "line_range": "420-432",
            "signature": "respond_conversationally(self, response_text)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9349422277846992,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 46,
        "functions": [
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_extract_detailed_examples",
            "line_range": "388-419",
            "signature": "_extract_detailed_examples(self, text)",
            "complexity": 11
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_extract_instructions",
            "line_range": "767-805",
            "signature": "_extract_instructions(self, results, tool_name)",
            "complexity": 17
          },
          {
            "file": "src/agents/security_scanner_agent.py",
            "name": "_extract_install_commands",
            "line_range": "582-603",
            "signature": "_extract_install_commands(self, guide_text)",
            "complexity": 5
          }
        ]
      },
      {
        "similarity_score": 0.9319743739131604,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_extract_advanced_features",
            "line_range": "435-452",
            "signature": "_extract_advanced_features(self, text)",
            "complexity": 3
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_extract_error_codes",
            "line_range": "454-466",
            "signature": "_extract_error_codes(self, text)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9369604531532916,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 117,
        "functions": [
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_command_examples",
            "line_range": "916-936",
            "signature": "_format_command_examples(self, examples)",
            "complexity": 5
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_procedures",
            "line_range": "995-1017",
            "signature": "_format_procedures(self, procedures)",
            "complexity": 7
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_troubleshooting",
            "line_range": "1026-1042",
            "signature": "_format_troubleshooting(self, issues)",
            "complexity": 4
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_documentation_examples",
            "line_range": "1051-1072",
            "signature": "_format_documentation_examples(self, examples)",
            "complexity": 7
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_tool_requirements",
            "line_range": "1147-1165",
            "signature": "_format_tool_requirements(self, tools)",
            "complexity": 5
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_workflow_steps",
            "line_range": "1167-1193",
            "signature": "_format_workflow_steps(self, steps)",
            "complexity": 8
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_decision_points",
            "line_range": "1195-1211",
            "signature": "_format_decision_points(self, decisions)",
            "complexity": 4
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_pitfalls",
            "line_range": "1220-1234",
            "signature": "_format_pitfalls(self, pitfalls)",
            "complexity": 4
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_alternatives",
            "line_range": "1236-1250",
            "signature": "_format_alternatives(self, alternatives)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9999999999999998,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 1,
        "functions": [
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_best_practices",
            "line_range": "1044-1049",
            "signature": "_format_best_practices(self, practices)",
            "complexity": 2
          },
          {
            "file": "src/agents/enhanced_kb_librarian.py",
            "name": "_format_prerequisites",
            "line_range": "1141-1145",
            "signature": "_format_prerequisites(self, prereqs)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9459246685032638,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 22,
        "functions": [
          {
            "file": "src/agents/network_discovery_agent.py",
            "name": "execute",
            "line_range": "32-57",
            "signature": "execute(self, task, context)",
            "complexity": 8
          },
          {
            "file": "src/agents/security_scanner_agent.py",
            "name": "execute",
            "line_range": "33-73",
            "signature": "execute(self, task, context)",
            "complexity": 10
          }
        ]
      },
      {
        "similarity_score": 0.9186697330896811,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 37,
        "functions": [
          {
            "file": "src/agents/network_discovery_agent.py",
            "name": "_parse_arp_scan",
            "line_range": "424-444",
            "signature": "_parse_arp_scan(self, output)",
            "complexity": 5
          },
          {
            "file": "src/agents/network_discovery_agent.py",
            "name": "_parse_nmap_output",
            "line_range": "471-487",
            "signature": "_parse_nmap_output(self, output)",
            "complexity": 5
          },
          {
            "file": "src/agents/security_scanner_agent.py",
            "name": "_parse_nmap_output",
            "line_range": "371-387",
            "signature": "_parse_nmap_output(self, output)",
            "complexity": 5
          },
          {
            "file": "src/agents/security_scanner_agent.py",
            "name": "_parse_nmap_services",
            "line_range": "389-403",
            "signature": "_parse_nmap_services(self, output)",
            "complexity": 5
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 5,
        "functions": [
          {
            "file": "src/agents/interactive_terminal_agent.py",
            "name": "_detect_sudo_prompt",
            "line_range": "164-172",
            "signature": "_detect_sudo_prompt(self, output)",
            "complexity": 1
          },
          {
            "file": "src/agents/interactive_terminal_agent.py",
            "name": "_detect_input_prompt",
            "line_range": "174-186",
            "signature": "_detect_input_prompt(self, output)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0000000000000002,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/agents/interactive_terminal_agent.py",
            "name": "_handle_sudo_prompt",
            "line_range": "188-206",
            "signature": "_handle_sudo_prompt(self, prompt_data)",
            "complexity": 1
          },
          {
            "file": "src/agents/interactive_terminal_agent.py",
            "name": "_handle_input_prompt",
            "line_range": "208-220",
            "signature": "_handle_input_prompt(self, prompt_data)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9453726230607863,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 12,
        "functions": [
          {
            "file": "src/agents/system_command_agent.py",
            "name": "get_active_sessions",
            "line_range": "410-422",
            "signature": "get_active_sessions(self)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal.py",
            "name": "get_active_sessions",
            "line_range": "264-272",
            "signature": "get_active_sessions()",
            "complexity": 2
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "get_active_sessions",
            "line_range": "381-391",
            "signature": "get_active_sessions(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9584381565197087,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 4,
        "functions": [
          {
            "file": "src/agents/system_command_agent.py",
            "name": "take_control_of_session",
            "line_range": "435-442",
            "signature": "take_control_of_session(self, chat_id)",
            "complexity": 2
          },
          {
            "file": "src/agents/system_command_agent.py",
            "name": "return_control_of_session",
            "line_range": "444-451",
            "signature": "return_control_of_session(self, chat_id)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9572573449887299,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 12,
        "functions": [
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "get_librarian_assistant",
            "line_range": "746-755",
            "signature": "get_librarian_assistant()",
            "complexity": 2
          },
          {
            "file": "src/agents/kb_librarian_agent.py",
            "name": "get_kb_librarian",
            "line_range": "232-241",
            "signature": "get_kb_librarian()",
            "complexity": 2
          },
          {
            "file": "src/agents/containerized_librarian_assistant.py",
            "name": "get_containerized_librarian_assistant",
            "line_range": "503-512",
            "signature": "get_containerized_librarian_assistant()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.991877815554671,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 72,
        "functions": [
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "_extract_duckduckgo_results",
            "line_range": "187-231",
            "signature": "_extract_duckduckgo_results(self, page)",
            "complexity": 7
          },
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "_extract_bing_results",
            "line_range": "233-271",
            "signature": "_extract_bing_results(self, page)",
            "complexity": 7
          },
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "_extract_google_results",
            "line_range": "273-313",
            "signature": "_extract_google_results(self, page)",
            "complexity": 9
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 99,
        "functions": [
          {
            "file": "src/agents/librarian_assistant_agent.py",
            "name": "research_query",
            "line_range": "592-694",
            "signature": "research_query(self, query, store_quality_content)",
            "complexity": 12
          },
          {
            "file": "src/agents/containerized_librarian_assistant.py",
            "name": "research_query",
            "line_range": "341-451",
            "signature": "research_query(self, query, store_quality_content)",
            "complexity": 13
          }
        ]
      },
      {
        "similarity_score": 0.9507325416758589,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 19,
        "functions": [
          {
            "file": "src/agents/enhanced_system_commands_agent.py",
            "name": "__init__",
            "line_range": "24-119",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "__init__",
            "line_range": "22-34",
            "signature": "__init__(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "__init__",
            "line_range": "22-35",
            "signature": "__init__(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9430205964549737,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 205,
        "functions": [
          {
            "file": "src/agents/enhanced_system_commands_agent.py",
            "name": "process_request",
            "line_range": "121-170",
            "signature": "process_request(self, request)",
            "complexity": 5
          },
          {
            "file": "src/agents/agent_client.py",
            "name": "process_request",
            "line_range": "117-156",
            "signature": "process_request(self, request)",
            "complexity": 4
          },
          {
            "file": "src/agents/agent_client.py",
            "name": "process_request",
            "line_range": "248-298",
            "signature": "process_request(self, request)",
            "complexity": 5
          },
          {
            "file": "src/agents/classification_agent.py",
            "name": "process_request",
            "line_range": "53-100",
            "signature": "process_request(self, request)",
            "complexity": 3
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "process_request",
            "line_range": "36-71",
            "signature": "process_request(self, request)",
            "complexity": 4
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "process_request",
            "line_range": "37-102",
            "signature": "process_request(self, request)",
            "complexity": 5
          }
        ]
      },
      {
        "similarity_score": 0.9975210667421646,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 88,
        "functions": [
          {
            "file": "src/agents/enhanced_system_commands_agent.py",
            "name": "_extract_response_content",
            "line_range": "422-447",
            "signature": "_extract_response_content(self, response)",
            "complexity": 13
          },
          {
            "file": "src/agents/agent_orchestrator.py",
            "name": "_extract_response_content",
            "line_range": "624-649",
            "signature": "_extract_response_content(self, response)",
            "complexity": 13
          },
          {
            "file": "src/agents/knowledge_retrieval_agent.py",
            "name": "_extract_response_content",
            "line_range": "351-376",
            "signature": "_extract_response_content(self, response)",
            "complexity": 13
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "_extract_response_content",
            "line_range": "176-206",
            "signature": "_extract_response_content(self, response)",
            "complexity": 13
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "_extract_response_content",
            "line_range": "448-473",
            "signature": "_extract_response_content(self, response)",
            "complexity": 13
          }
        ]
      },
      {
        "similarity_score": 0.9119738360523574,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 81,
        "functions": [
          {
            "file": "src/agents/enhanced_system_commands_agent.py",
            "name": "is_system_command_request",
            "line_range": "449-489",
            "signature": "is_system_command_request(self, message)",
            "complexity": 1
          },
          {
            "file": "src/agents/knowledge_retrieval_agent.py",
            "name": "is_knowledge_retrieval_appropriate",
            "line_range": "403-450",
            "signature": "is_knowledge_retrieval_appropriate(self, message)",
            "complexity": 5
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "is_chat_appropriate",
            "line_range": "208-275",
            "signature": "is_chat_appropriate(self, message)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9586702518715597,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 94,
        "functions": [
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "_search_duckduckgo",
            "line_range": "361-412",
            "signature": "_search_duckduckgo(self, query, max_results)",
            "complexity": 7
          },
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "_search_bing",
            "line_range": "414-463",
            "signature": "_search_bing(self, query, max_results)",
            "complexity": 7
          },
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "_search_google",
            "line_range": "465-538",
            "signature": "_search_google(self, query, max_results)",
            "complexity": 11
          }
        ]
      },
      {
        "similarity_score": 0.9279029035340323,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 31,
        "functions": [
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "_calculate_quality_score",
            "line_range": "713-747",
            "signature": "_calculate_quality_score(self, result)",
            "complexity": 6
          },
          {
            "file": "src/agents/web_research_assistant.py",
            "name": "_calculate_quality_score",
            "line_range": "263-297",
            "signature": "_calculate_quality_score(self, result, query)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.939207129135406,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "close",
            "line_range": "813-818",
            "signature": "close(self)",
            "complexity": 3
          },
          {
            "file": "src/agents/advanced_web_research.py",
            "name": "__aexit__",
            "line_range": "824-825",
            "signature": "__aexit__(self, exc_type, exc_val, exc_tb)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.932397814178673,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 48,
        "functions": [
          {
            "file": "src/agents/agent_orchestrator.py",
            "name": "_get_routing_system_prompt",
            "line_range": "495-517",
            "signature": "_get_routing_system_prompt(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/chat_agent.py",
            "name": "_get_chat_system_prompt",
            "line_range": "156-174",
            "signature": "_get_chat_system_prompt(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "_get_rag_system_prompt",
            "line_range": "291-317",
            "signature": "_get_rag_system_prompt(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/rag_agent.py",
            "name": "_get_query_reformulation_prompt",
            "line_range": "319-336",
            "signature": "_get_query_reformulation_prompt(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9276782102153183,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 30,
        "functions": [
          {
            "file": "src/agents/system_knowledge_manager.py",
            "name": "_import_tools_knowledge",
            "line_range": "337-356",
            "signature": "_import_tools_knowledge(self)",
            "complexity": 4
          },
          {
            "file": "src/agents/system_knowledge_manager.py",
            "name": "_import_workflows_knowledge",
            "line_range": "424-442",
            "signature": "_import_workflows_knowledge(self)",
            "complexity": 3
          },
          {
            "file": "src/agents/system_knowledge_manager.py",
            "name": "_import_procedures_knowledge",
            "line_range": "482-500",
            "signature": "_import_procedures_knowledge(self)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9612275932558787,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 9,
        "functions": [
          {
            "file": "src/agents/system_knowledge_manager.py",
            "name": "_format_pitfalls",
            "line_range": "468-480",
            "signature": "_format_pitfalls(self, pitfalls_data)",
            "complexity": 2
          },
          {
            "file": "src/agents/system_knowledge_manager.py",
            "name": "_format_procedure_issues",
            "line_range": "525-537",
            "signature": "_format_procedure_issues(self, issues_data)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 19,
        "functions": [
          {
            "file": "src/agents/web_research_assistant.py",
            "name": "_get_nmap_content",
            "line_range": "345-373",
            "signature": "_get_nmap_content(self)",
            "complexity": 1
          },
          {
            "file": "src/agents/web_research_assistant.py",
            "name": "_get_forensics_content",
            "line_range": "390-412",
            "signature": "_get_forensics_content(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "backend/app_factory.py",
            "name": "add_security_headers",
            "line_range": "372-390",
            "signature": "add_security_headers(request, call_next)",
            "complexity": 3
          },
          {
            "file": "backend/app_factory.py",
            "name": "not_found_handler",
            "line_range": "645-646",
            "signature": "not_found_handler(request, exc)",
            "complexity": 1
          },
          {
            "file": "backend/app_factory.py",
            "name": "method_not_allowed_handler",
            "line_range": "649-650",
            "signature": "method_not_allowed_handler(request, exc)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9570316928151625,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 177,
        "functions": [
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_create_smart_development_environment_template",
            "line_range": "150-198",
            "signature": "_create_smart_development_environment_template(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_create_intelligent_security_hardening_template",
            "line_range": "200-250",
            "signature": "_create_intelligent_security_hardening_template(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_create_adaptive_deployment_template",
            "line_range": "252-299",
            "signature": "_create_adaptive_deployment_template(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_create_predictive_maintenance_template",
            "line_range": "301-348",
            "signature": "_create_predictive_maintenance_template(self)",
            "complexity": 1
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_create_ai_backup_strategy_template",
            "line_range": "350-397",
            "signature": "_create_ai_backup_strategy_template(self)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9659432744592278,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 11,
        "functions": [
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_generate_validation_command",
            "line_range": "655-674",
            "signature": "_generate_validation_command(self, command)",
            "complexity": 7
          },
          {
            "file": "backend/api/advanced_workflow_orchestrator.py",
            "name": "_generate_rollback_command",
            "line_range": "676-690",
            "signature": "_generate_rollback_command(self, command)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9431485101123912,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 5,
        "functions": [
          {
            "file": "backend/api/secure_terminal_websocket.py",
            "name": "__init__",
            "line_range": "24-42",
            "signature": "__init__(self, session_id, security_layer, user_role)",
            "complexity": 1
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "__init__",
            "line_range": "31-39",
            "signature": "__init__(self, session_id)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9963709052095813,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 17,
        "functions": [
          {
            "file": "backend/api/secure_terminal_websocket.py",
            "name": "connect",
            "line_range": "44-68",
            "signature": "connect(self, websocket)",
            "complexity": 1
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "connect",
            "line_range": "41-61",
            "signature": "connect(self, websocket)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 29,
        "functions": [
          {
            "file": "backend/api/secure_terminal_websocket.py",
            "name": "start_pty_shell",
            "line_range": "70-102",
            "signature": "start_pty_shell(self)",
            "complexity": 2
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "start_pty_shell",
            "line_range": "71-104",
            "signature": "start_pty_shell(self)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9399337098471929,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 14,
        "functions": [
          {
            "file": "backend/api/secure_terminal_websocket.py",
            "name": "execute_command",
            "line_range": "219-236",
            "signature": "execute_command(self, command)",
            "complexity": 3
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "execute_command",
            "line_range": "155-172",
            "signature": "execute_command(self, command)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9394434245543832,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 3,
        "functions": [
          {
            "file": "backend/api/secure_terminal_websocket.py",
            "name": "send_message",
            "line_range": "238-244",
            "signature": "send_message(self, message)",
            "complexity": 4
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "send_message",
            "line_range": "63-69",
            "signature": "send_message(self, data)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.948729509168073,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 29,
        "functions": [
          {
            "file": "backend/api/secure_terminal_websocket.py",
            "name": "disconnect",
            "line_range": "246-282",
            "signature": "disconnect(self)",
            "complexity": 7
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "disconnect",
            "line_range": "293-325",
            "signature": "disconnect(self)",
            "complexity": 9
          }
        ]
      },
      {
        "similarity_score": 0.939826565372205,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 7,
        "functions": [
          {
            "file": "backend/api/metrics.py",
            "name": "start_system_monitoring",
            "line_range": "126-140",
            "signature": "start_system_monitoring()",
            "complexity": 2
          },
          {
            "file": "backend/api/metrics.py",
            "name": "stop_system_monitoring",
            "line_range": "144-154",
            "signature": "stop_system_monitoring()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.948253943650373,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 31,
        "functions": [
          {
            "file": "backend/api/prompts.py",
            "name": "save_prompt",
            "line_range": "68-102",
            "signature": "save_prompt(prompt_id, request)",
            "complexity": 2
          },
          {
            "file": "backend/api/prompts.py",
            "name": "revert_prompt",
            "line_range": "106-148",
            "signature": "revert_prompt(prompt_id)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9437164462510139,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 6,
        "functions": [
          {
            "file": "backend/api/llm.py",
            "name": "update_llm_config",
            "line_range": "29-38",
            "signature": "update_llm_config(config_data)",
            "complexity": 2
          },
          {
            "file": "backend/api/redis.py",
            "name": "update_redis_config",
            "line_range": "26-35",
            "signature": "update_redis_config(config_data)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9260552996758256,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 54,
        "functions": [
          {
            "file": "backend/api/llm.py",
            "name": "update_llm_provider",
            "line_range": "95-171",
            "signature": "update_llm_provider(provider_data)",
            "complexity": 9
          },
          {
            "file": "backend/api/llm.py",
            "name": "update_embedding_model",
            "line_range": "219-276",
            "signature": "update_embedding_model(embedding_data)",
            "complexity": 6
          }
        ]
      },
      {
        "similarity_score": 0.9522723462468494,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 18,
        "functions": [
          {
            "file": "backend/api/knowledge.py",
            "name": "get_knowledge_stats",
            "line_range": "365-389",
            "signature": "get_knowledge_stats()",
            "complexity": 4
          },
          {
            "file": "backend/api/knowledge.py",
            "name": "get_detailed_knowledge_stats",
            "line_range": "393-414",
            "signature": "get_detailed_knowledge_stats()",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9570906278586486,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 29,
        "functions": [
          {
            "file": "backend/api/knowledge.py",
            "name": "import_system_documentation",
            "line_range": "924-956",
            "signature": "import_system_documentation()",
            "complexity": 5
          },
          {
            "file": "backend/api/knowledge.py",
            "name": "import_system_prompts",
            "line_range": "960-992",
            "signature": "import_system_prompts()",
            "complexity": 5
          }
        ]
      },
      {
        "similarity_score": 0.9901125949480319,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 19,
        "functions": [
          {
            "file": "backend/api/agent.py",
            "name": "pause_agent_api",
            "line_range": "152-174",
            "signature": "pause_agent_api(request, user_role)",
            "complexity": 2
          },
          {
            "file": "backend/api/agent.py",
            "name": "resume_agent_api",
            "line_range": "178-202",
            "signature": "resume_agent_api(request, user_role)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9273851267829957,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 5,
        "functions": [
          {
            "file": "backend/api/settings.py",
            "name": "get_backend_settings",
            "line_range": "39-47",
            "signature": "get_backend_settings()",
            "complexity": 2
          },
          {
            "file": "backend/api/settings.py",
            "name": "save_backend_settings",
            "line_range": "51-60",
            "signature": "save_backend_settings(backend_settings)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9309104696395873,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 21,
        "functions": [
          {
            "file": "backend/api/chat.py",
            "name": "_extract_text_from_complex_json",
            "line_range": "113-153",
            "signature": "_extract_text_from_complex_json(data, max_length)",
            "complexity": 15
          },
          {
            "file": "backend/api/chat.py",
            "name": "extract_recursive",
            "line_range": "120-144",
            "signature": "extract_recursive(obj, depth)",
            "complexity": 13
          }
        ]
      },
      {
        "similarity_score": 0.931302335259349,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 16,
        "functions": [
          {
            "file": "backend/api/chat.py",
            "name": "get_chat",
            "line_range": "221-240",
            "signature": "get_chat(chat_id, request)",
            "complexity": 4
          },
          {
            "file": "backend/api/chat.py",
            "name": "delete_chat",
            "line_range": "244-285",
            "signature": "delete_chat(chat_id, request)",
            "complexity": 10
          }
        ]
      },
      {
        "similarity_score": 0.9275065484534389,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "backend/api/terminal.py",
            "name": "websocket_terminal",
            "line_range": "58-60",
            "signature": "websocket_terminal(websocket, chat_id)",
            "complexity": 1
          },
          {
            "file": "backend/api/terminal.py",
            "name": "websocket_simple_terminal",
            "line_range": "64-66",
            "signature": "websocket_simple_terminal(websocket, session_id)",
            "complexity": 1
          },
          {
            "file": "backend/api/terminal.py",
            "name": "websocket_secure_terminal",
            "line_range": "70-74",
            "signature": "websocket_secure_terminal(websocket, session_id)",
            "complexity": 1
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "simple_terminal_websocket_endpoint",
            "line_range": "398-400",
            "signature": "simple_terminal_websocket_endpoint(websocket, session_id)",
            "complexity": 1
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "terminal_websocket_endpoint",
            "line_range": "306-308",
            "signature": "terminal_websocket_endpoint(websocket, chat_id)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.984962243371428,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 7,
        "functions": [
          {
            "file": "backend/api/terminal.py",
            "name": "create_session",
            "line_range": "78-98",
            "signature": "create_session(request)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal.py",
            "name": "create_terminal_session",
            "line_range": "250-260",
            "signature": "create_terminal_session()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.957057407452107,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 5,
        "functions": [
          {
            "file": "backend/api/terminal.py",
            "name": "get_sessions",
            "line_range": "102-110",
            "signature": "get_sessions()",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal.py",
            "name": "get_simple_sessions",
            "line_range": "276-284",
            "signature": "get_simple_sessions()",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9576186335130473,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 11,
        "functions": [
          {
            "file": "backend/api/terminal.py",
            "name": "get_session_info",
            "line_range": "114-128",
            "signature": "get_session_info(session_id)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal.py",
            "name": "get_session_info",
            "line_range": "288-302",
            "signature": "get_session_info(session_id)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.956643985332406,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 4,
        "functions": [
          {
            "file": "backend/api/terminal.py",
            "name": "close_session",
            "line_range": "132-139",
            "signature": "close_session(session_id)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal.py",
            "name": "delete_terminal_session",
            "line_range": "306-314",
            "signature": "delete_terminal_session(session_id)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9484500479902461,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 12,
        "functions": [
          {
            "file": "backend/api/terminal.py",
            "name": "send_terminal_input",
            "line_range": "318-333",
            "signature": "send_terminal_input(chat_id, request)",
            "complexity": 3
          },
          {
            "file": "backend/api/terminal.py",
            "name": "send_terminal_signal",
            "line_range": "377-400",
            "signature": "send_terminal_signal(chat_id, signal_type)",
            "complexity": 4
          }
        ]
      },
      {
        "similarity_score": 0.9305965827363034,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 52,
        "functions": [
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "handle_workflow_control",
            "line_range": "174-229",
            "signature": "handle_workflow_control(self, data)",
            "complexity": 12
          },
          {
            "file": "backend/api/simple_terminal_websocket.py",
            "name": "handle_workflow_message",
            "line_range": "231-291",
            "signature": "handle_workflow_message(self, data)",
            "complexity": 8
          }
        ]
      },
      {
        "similarity_score": 0.9596250280834238,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 7,
        "functions": [
          {
            "file": "backend/api/advanced_control.py",
            "name": "pause_takeover_session",
            "line_range": "232-242",
            "signature": "pause_takeover_session(session_id)",
            "complexity": 3
          },
          {
            "file": "backend/api/advanced_control.py",
            "name": "resume_takeover_session",
            "line_range": "246-256",
            "signature": "resume_takeover_session(session_id)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9307693936017998,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "_send_message",
            "line_range": "279-285",
            "signature": "_send_message(self, websocket, message)",
            "complexity": 3
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "_send_error",
            "line_range": "292-294",
            "signature": "_send_error(self, websocket, error)",
            "complexity": 1
          }
        ]
      },
      {
        "similarity_score": 0.9498934694163119,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 36,
        "functions": [
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "_subscribe_to_terminal_events",
            "line_range": "194-277",
            "signature": "_subscribe_to_terminal_events(self, chat_id, websocket)",
            "complexity": 7
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "handle_terminal_output",
            "line_range": "197-207",
            "signature": "handle_terminal_output(event_data)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "handle_terminal_control",
            "line_range": "209-218",
            "signature": "handle_terminal_control(event_data)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "handle_terminal_session",
            "line_range": "220-230",
            "signature": "handle_terminal_session(event_data)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "handle_command_execution",
            "line_range": "232-244",
            "signature": "handle_command_execution(event_data)",
            "complexity": 2
          },
          {
            "file": "backend/api/terminal_websocket.py",
            "name": "handle_command_confirmation",
            "line_range": "246-256",
            "signature": "handle_command_confirmation(event_data)",
            "complexity": 2
          }
        ]
      },
      {
        "similarity_score": 0.9639647222503063,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 23,
        "functions": [
          {
            "file": "backend/api/voice.py",
            "name": "voice_listen_api",
            "line_range": "11-37",
            "signature": "voice_listen_api(request, user_role)",
            "complexity": 3
          },
          {
            "file": "backend/api/voice.py",
            "name": "voice_speak_api",
            "line_range": "41-75",
            "signature": "voice_speak_api(request, text, user_role)",
            "complexity": 3
          }
        ]
      },
      {
        "similarity_score": 0.9286690810658119,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 88,
        "functions": [
          {
            "file": "backend/utils/connection_utils.py",
            "name": "test_ollama_connection",
            "line_range": "23-125",
            "signature": "test_ollama_connection()",
            "complexity": 13
          },
          {
            "file": "backend/utils/connection_utils.py",
            "name": "test_redis_connection",
            "line_range": "128-219",
            "signature": "test_redis_connection()",
            "complexity": 15
          }
        ]
      },
      {
        "similarity_score": 1.0,
        "refactoring_suggestion": "Consider extracting common logic",
        "estimated_lines_saved": 0,
        "functions": [
          {
            "file": "backend/models/settings.py",
            "name": "validate_port",
            "line_range": "68-71",
            "signature": "validate_port(cls, v)",
            "complexity": 2
          },
          {
            "file": "backend/models/settings.py",
            "name": "validate_port",
            "line_range": "124-127",
            "signature": "validate_port(cls, v)",
            "complexity": 2
          },
          {
            "file": "backend/models/settings.py",
            "name": "validate_transport",
            "line_range": "201-206",
            "signature": "validate_transport(cls, v)",
            "complexity": 2
          }
        ]
      }
    ],
    "refactoring_suggestions": [
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions __init__, __init__, __init__ are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/modern_ai_integration.py"
        ],
        "example_refactoring": "# In src/utils/modern_ai_integration_utils.py:\n    def __init__(self, config: AIModelConfig):\n        super().__init__(config)\n        self.client = None\n        self._initialize_client()\n\n# In original files, replace with:\nfrom src.utils.modern_ai_integration_utils import __init__"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _create_error_response, _create_error_response, _create_error_response are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/modern_ai_integration.py"
        ],
        "example_refactoring": "# In src/utils/modern_ai_integration_utils.py:\n    def _create_error_response(self, request: AIRequest, error_message: str) -> AIResponse:\n        \"\"\"Create error response\"\"\"\n        return AIResponse(\n            request_id=request.request_id,\n            provider=self.config.provider,\n            model_name=self.config.model_name,\n            content=f\"Error: {error_message}\",\n            usage={\"prompt_tokens\": 0, \"completion_tokens\": 0},\n            finish_reason=\"error\",\n            tool_calls=None,\n            confidence=0.0,\n            processing_time=0.0,\n            metadata={\"error\": error_message}\n        )\n\n# In original files, replace with:\nfrom src.utils.modern_ai_integration_utils import _create_error_response"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _get_timestamp, _get_timestamp are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/intelligence/streaming_executor.py",
          "src/intelligence/intelligent_agent.py"
        ],
        "example_refactoring": "# In src/utils/intelligent_agent_utils.py:\n    def _get_timestamp(self) -> str:\n        \"\"\"Get current timestamp in ISO format.\"\"\"\n        return datetime.now().isoformat()\n\n# In original files, replace with:\nfrom src.utils.intelligent_agent_utils import _get_timestamp"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _run_command, _run_command are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/network_discovery_agent.py",
          "src/agents/security_scanner_agent.py"
        ],
        "example_refactoring": "# In src/utils/network_discovery_agent_utils.py:\n    async def _run_command(self, cmd: List[str], timeout: int = 60) -> Dict[str, Any]:\n        \"\"\"Run a command with timeout\"\"\"\n        try:\n            process = await asyncio.create_subprocess_exec(\n                *cmd, stdout=asyncio.subprocess.PIPE, stderr=asyncio.subprocess.PIPE\n            )\n\n            stdout, stderr = await asyncio.wait_for(\n                process.communicate(), timeout=timeout\n            )\n\n            if process.returncode == 0:\n                return {\"status\": \"success\", \"output\": stdout.decode()}\n            else:\n                return {\n                    \"status\": \"error\",\n                    \"message\": f\"Command failed: {stderr.decode()}\",\n                }\n\n        except asyncio.TimeoutError:\n            return {\n                \"status\": \"error\",\n                \"message\": f\"Command timed out after {timeout} seconds\",\n            }\n        except Exception as e:\n            return {\"status\": \"error\", \"message\": f\"Command execution failed: {str(e)}\"}\n\n# In original files, replace with:\nfrom src.utils.network_discovery_agent_utils import _run_command"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions assess_content_quality, assess_content_quality are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/containerized_librarian_assistant.py",
          "src/agents/librarian_assistant_agent.py"
        ],
        "example_refactoring": "# In src/utils/librarian_assistant_agent_utils.py:\n    async def assess_content_quality(\n        self, content_data: Dict[str, Any]\n    ) -> Dict[str, Any]:\n        \"\"\"Assess the quality of extracted content using LLM.\n\n        Args:\n            content_data: Content data with text and metadata\n\n        Returns:\n            Quality assessment with score and reasoning\n        \"\"\"\n        try:\n            prompt = f\"\"\"\nPlease assess the quality and reliability of this web content for \"\n\"inclusion in a knowledge base:\n\nTitle: {content_data.get('title', 'N/A')}\nDomain: {content_data.get('domain', 'N/A')}\nIs Trusted Domain: {content_data.get('is_trusted', False)}\nContent Length: {content_data.get('content_length', 0)} characters\n\nContent Sample (first 500 chars):\n{content_data.get('content', '')[:500]}...\n\nPlease evaluate on a scale of 0.0 to 1.0 based on:\n1. Factual accuracy and reliability\n2. Information completeness\n3. Source credibility\n4. Content structure and clarity\n5. Relevance and usefulness\n\nRespond in JSON format:\n{{\n    \"score\": 0.0-1.0,\n    \"reasoning\": \"Brief explanation of the assessment\",\n    \"recommendation\": \"store|review|reject\",\n    \"key_topics\": [\"list\", \"of\", \"main\", \"topics\"],\n    \"reliability_factors\": {{\n        \"trusted_domain\": true/false,\n        \"content_quality\": \"high/medium/low\",\n        \"information_density\": \"high/medium/low\"\n    }}\n}}\n\"\"\"\n\n            response = await self.llm.chat([{\"role\": \"user\", \"content\": prompt}])\n\n            # Try to parse JSON response\n            try:\n                assessment = json.loads(response)\n                # Ensure score is within valid range\n                score = max(0.0, min(1.0, float(assessment.get(\"score\", 0.5))))\n                assessment[\"score\"] = score\n                return assessment\n            except json.JSONDecodeError:\n                # Fallback assessment\n                logger.warning(\n                    \"Could not parse quality assessment JSON, using fallback\"\n                )\n                return {\n                    \"score\": 0.6 if content_data.get(\"is_trusted\") else 0.4,\n                    \"reasoning\": (\n                        \"Automatic assessment - LLM response could not be parsed\"\n                    ),\n                    \"recommendation\": \"review\",\n                    \"key_topics\": [],\n                    \"reliability_factors\": {\n                        \"trusted_domain\": content_data.get(\"is_trusted\", False),\n                        \"content_quality\": \"medium\",\n                        \"information_density\": \"medium\",\n                    },\n                }\n\n        except Exception as e:\n            logger.error(f\"Error assessing content quality: {e}\")\n            return {\n                \"score\": 0.3,\n                \"reasoning\": f\"Error during assessment: {str(e)}\",\n                \"recommendation\": \"review\",\n                \"key_topics\": [],\n                \"reliability_factors\": {\n                    \"trusted_domain\": False,\n                    \"content_quality\": \"unknown\",\n                    \"information_density\": \"unknown\",\n                },\n            }\n\n# In original files, replace with:\nfrom src.utils.librarian_assistant_agent_utils import assess_content_quality"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _create_research_summary, _create_research_summary are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/containerized_librarian_assistant.py",
          "src/agents/librarian_assistant_agent.py"
        ],
        "example_refactoring": "# In src/utils/librarian_assistant_agent_utils.py:\n    async def _create_research_summary(\n        self, query: str, content_list: List[Dict[str, Any]]\n    ) -> str:\n        \"\"\"Create a summary of research findings.\"\"\"\n        try:\n            # Prepare content for summarization\n            source_contents = []\n            for i, content in enumerate(content_list, 1):\n                quality_info = content.get(\"quality_assessment\", {})\n                source_contents.append(\n                    f\"Source {i} - {content['title']} ({content['domain']})\\n\"\n                    f\"Quality Score: {quality_info.get('score', 'N/A')}\\n\"\n                    f\"Content: {content['content'][:800]}...\\n\"\n                )\n\n            combined_content = \"\\n---\\n\".join(source_contents)\n\n            prompt = f\"\"\"\nBased on the following web research results for the query \\\"{query}\\\", \"\n\"please provide a comprehensive summary that:\n\n1. Synthesizes the key information found\n2. Clearly attributes information to sources\n3. Notes any contradictions or uncertainties\n4. Highlights the most reliable information\n\nResearch Results:\n{combined_content}\n\nPlease format your response to include:\n- Main findings with source attribution\n- Key facts and concepts discovered\n- Source reliability assessment\n- Any limitations or gaps in the information\n\nFormat sources as: [Source: Domain Name]\n\"\"\"\n\n            summary = await self.llm.chat([{\"role\": \"user\", \"content\": prompt}])\n            return summary\n\n        except Exception as e:\n            logger.error(f\"Error creating research summary: {e}\")\n            return f\"Research completed but summary generation failed: {str(e)}\"\n\n# In original files, replace with:\nfrom src.utils.librarian_assistant_agent_utils import _create_research_summary"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions get_capabilities, get_capabilities, get_capabilities, get_capabilities are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/classification_agent.py",
          "src/agents/chat_agent.py",
          "src/agents/enhanced_system_commands_agent.py",
          "src/agents/rag_agent.py"
        ],
        "example_refactoring": "# In src/utils/enhanced_system_commands_agent_utils.py:\n    def get_capabilities(self) -> List[str]:\n        \"\"\"Return list of capabilities this agent supports.\"\"\"\n        return self.capabilities.copy()\n\n# In original files, replace with:\nfrom src.utils.enhanced_system_commands_agent_utils import get_capabilities"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _determine_required_context, generate_validation_report, get_hardware_recommendations, _build_context_string are 91% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/project_state_manager.py",
          "src/voice_processing_system.py",
          "src/agents/enhanced_system_commands_agent.py",
          "src/hardware_acceleration.py"
        ],
        "differences": [
          "Different signatures: generate_validation_report(self), _determine_required_context(self, command_analysis), get_hardware_recommendations(self), _build_context_string(self, context)",
          "Different function calls: sum, join, replace, get, strftime, title, extend, items, now, len, get_project_status"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_command_history, get_command_history are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/voice_processing_system.py",
          "src/secure_command_executor.py"
        ],
        "differences": [
          "Different function calls: get"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_system_status, get_system_status are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/voice_processing_system.py",
          "src/context_aware_decision_system.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _screenshot, click_element, read_text_from_region, move_mouse, bring_window_to_front are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/gui_controller_dummy.py"
        ],
        "differences": [
          "Different signatures: _screenshot(self, region), read_text_from_region(self, x, y, width, height), move_mouse(self, x, y, duration), bring_window_to_front(self, app_title), click_element(self, image_path, confidence, button, clicks, interval)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions main, test_voice_interface, main, start_virtual_display, example_approval_callback, test_commands, test_detector, test_agent, test_processor, test_executor, test_research, main, demo_intelligent_workflow are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/research_agent.py",
          "src/voice_interface.py",
          "src/command_executor.py",
          "src/intelligence/os_detector.py",
          "src/secure_command_executor.py",
          "src/intelligence/streaming_executor.py",
          "src/intelligence/intelligent_agent.py",
          "src/agents/classification_agent.py",
          "src/gui_controller.py",
          "src/code_analyzer.py",
          "src/intelligence/goal_processor.py",
          "backend/api/advanced_workflow_orchestrator.py"
        ],
        "differences": [
          "Different signatures: example_approval_callback(approval_data), start_virtual_display(self), test_commands(), test_voice_interface(), test_research(), test_detector(), test_agent(), test_processor(), demo_intelligent_workflow(), main(), test_executor()",
          "Varying complexity: 1-9",
          "Different function calls: classify_request, get_command_history, join, MockLLMInterface, research_specific_tools, process_natural_language_goal, split, perform_research, items, CodeAnalyzer, generate_intelligent_workflow, StreamingCommandExecutor, ResearchRequest, dumps, IntelligentAgent, AdvancedWorkflowOrchestrator, analyze_codebase, enumerate, MockWorkerNode, get_classification_history, ClassificationAgent, Popen, upper, get_capabilities_info, title, get_similar_intents, GoalProcessor, input, detect_system, validate_installation_capability, run_shell_command, MockKnowledgeBase, SecureCommandExecutor, MockCommandValidator, strip, get_os_detector, get, process_goal, get_tool_installation_guide, execute_with_streaming, run, len, initialize, CommandExecutor"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__ are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/workflow_classifier.py",
          "src/code_analyzer.py"
        ],
        "differences": [
          "Different signatures: __init__(self, redis_client, use_npu), __init__(self, redis_client)",
          "Different function calls: TfidfVectorizer, _initialize_default_rules, error, info"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _collect_visual_context, _collect_audio_context are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/context_aware_decision_system.py"
        ],
        "differences": [
          "Different signatures: _collect_audio_context(self), _collect_visual_context(self)",
          "Different function calls: get_system_status, analyze_and_understand_screen, get_command_history"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _collect_system_context, _collect_historical_context are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/context_aware_decision_system.py"
        ],
        "differences": [
          "Different signatures: _collect_historical_context(self, decision_type), _collect_system_context(self)",
          "Different function calls: get_system_status, virtual_memory, get_active_sessions, len, cpu_percent, disk_usage"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _identify_available_actions, store_tool_knowledge, _combine_classifications, _create_sampling_params, websocket_endpoint, broadcast_event, get_system_documentation, get_system_prompts, get_health_summary are 88% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/context_aware_decision_system.py",
          "src/llm_providers/vllm_provider.py",
          "backend/api/knowledge.py",
          "backend/api/websockets.py",
          "src/agents/enhanced_kb_librarian.py",
          "backend/api/monitoring.py",
          "src/agents/classification_agent.py"
        ],
        "differences": [
          "Different signatures: websocket_endpoint(websocket), broadcast_event(event_data), _identify_available_actions(self, decision_type, context_elements), _create_sampling_params(self), get_system_prompts(), _combine_classifications(self, llm_result, keyword_result, user_message), store_tool_knowledge(self, tool_info), get_health_summary(), get_system_documentation()",
          "Varying complexity: 1-34",
          "Different function calls: TaskComplexity, get_all_facts, str, SamplingParams, extend, accept, loads, warning, init_knowledge_base, float, store_fact, _create_fallback_result, receive_text, dumps, isoformat, ClassificationResult, int, error, websocket, _format_command_examples, register_websocket_broadcast, now, append, publish, get_comprehensive_status, add_message, search, lower, debug, info, _extract_agents, send_json, len"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _assess_risk_factors, _generate_recommendations are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/computer_vision_system.py",
          "src/context_aware_decision_system.py"
        ],
        "differences": [
          "Different signatures: _generate_recommendations(self, screen_state), _assess_risk_factors(self, context_elements)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _create_no_action_decision, _create_placeholder_decision are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/context_aware_decision_system.py"
        ],
        "differences": [
          "Different signatures: _create_placeholder_decision(self, context, reason), _create_no_action_decision(self, context, reason)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __post_init__, __post_init__, __post_init__, __post_init__, __post_init__, __post_init__ are 99% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/utils/task_queue.py",
          "src/intelligence/intelligent_agent.py",
          "backend/api/workflow_automation.py",
          "src/workflow_scheduler.py",
          "src/workflow_templates.py"
        ],
        "differences": [
          "Varying complexity: 2-5",
          "Different function calls: utcnow, now"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _add_network_security_scan_template, _add_vulnerability_assessment_template, _add_security_audit_template, _add_comprehensive_research_template, _add_competitive_analysis_template, _add_technology_research_template, _add_system_health_check_template, _add_performance_optimization_template, _add_backup_and_recovery_template, _add_code_review_template, _add_deployment_pipeline_template, _add_testing_strategy_template, _add_data_analysis_template, _add_log_analysis_template, plan_workflow_steps, _create_system_update_workflow, _create_dev_environment_workflow are 98% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/orchestrator.py",
          "backend/api/workflow_automation.py",
          "src/workflow_templates.py"
        ],
        "differences": [
          "Different signatures: _add_vulnerability_assessment_template(self), _add_performance_optimization_template(self), _add_comprehensive_research_template(self), _add_code_review_template(self), _add_log_analysis_template(self), _add_data_analysis_template(self), _add_backup_and_recovery_template(self), _add_competitive_analysis_template(self), _add_deployment_pipeline_template(self), _add_testing_strategy_template(self), plan_workflow_steps(self, user_message, complexity), _add_technology_research_template(self), _create_dev_environment_workflow(self, session_id), _add_security_audit_template(self), _add_network_security_scan_template(self), _create_system_update_workflow(self, session_id), _add_system_health_check_template(self)",
          "Varying complexity: 1-6",
          "Different function calls: WorkflowTemplate"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions retry_async, retry_sync are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/retry_mechanism.py"
        ],
        "example_refactoring": "# In src/utils/retry_mechanism_utils.py:\ndef retry_async(\n    max_attempts: int = 3,\n    base_delay: float = 1.0,\n    max_delay: float = 60.0,\n    backoff_multiplier: float = 2.0,\n    strategy: RetryStrategy = RetryStrategy.EXPONENTIAL_BACKOFF,\n    retryable_exceptions: tuple = None,\n    operation_name: str = None\n):\n    \"\"\"\n    Decorator for async functions with retry mechanism\n    \n    Args:\n        max_attempts: Maximum number of retry attempts\n        base_delay: Base delay in seconds\n        max_delay: Maximum delay in seconds\n        backoff_multiplier: Multiplier for exponential backoff\n        strategy: Retry strategy to use\n        retryable_exceptions: Tuple of exceptions that should trigger retry\n        operation_name: Name for logging and stats (defaults to function name)\n    \"\"\"\n    def decorator(func):\n        @wraps(func)\n        async def wrapper(*args, **kwargs):\n            config = RetryConfig(\n                max_attempts=max_attempts,\n                base_delay=base_delay,\n                max_delay=max_delay,\n                backoff_multiplier=backoff_multiplier,\n                strategy=strategy\n            )\n            \n            if retryable_exceptions:\n                config.retryable_exceptions = retryable_exceptions\n            \n            retry_mechanism = RetryMechanism(config)\n            \n            return await retry_mechanism.execute_async(\n                func, *args,\n                operation_name=operation_name or func.__name__,\n                **kwargs\n            )\n        \n        return wrapper\n    return decorator\n\n# In original files, replace with:\nfrom src.utils.retry_mechanism_utils import retry_async"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions retry_database_operation, retry_network_operation are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/retry_mechanism.py"
        ],
        "differences": [
          "Different signatures: retry_network_operation(func), retry_database_operation(func)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions execute_async, execute_sync are 98% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/retry_mechanism.py"
        ],
        "differences": [
          "Different signatures: execute_sync(self, func), execute_async(self, func)",
          "Different function calls: iscoroutinefunction"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions decorator, decorator, decorator, decorator, decorator, decorator are 98% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/retry_mechanism.py",
          "src/circuit_breaker.py",
          "src/utils/task_queue.py"
        ],
        "differences": [
          "Different function calls: CircuitBreakerConfig, call_sync, copy, execute_async, update, RetryConfig, RetryMechanism, call_async, register_task, execute_sync, wraps, get_task_queue, get_circuit_breaker, enqueue"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions example_usage, test_listener, mock_websocket_broadcast are 91% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/retry_mechanism.py",
          "src/event_manager.py"
        ],
        "differences": [
          "Different signatures: test_listener(event), mock_websocket_broadcast(event), example_usage()",
          "Varying complexity: 1-5",
          "Different function calls: flaky_network_call, TimeoutError, execute_async, RetryConfig, RetryMechanism, ConnectionError, retry_async, random, get_stats"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions wrapper, wrapper, wrapper, wrapper are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/retry_mechanism.py",
          "src/circuit_breaker.py"
        ],
        "example_refactoring": "# In src/utils/retry_mechanism_utils.py:\n        async def wrapper(*args, **kwargs):\n            config = RetryConfig(\n                max_attempts=max_attempts,\n                base_delay=base_delay,\n                max_delay=max_delay,\n                backoff_multiplier=backoff_multiplier,\n                strategy=strategy\n            )\n            \n            if retryable_exceptions:\n                config.retryable_exceptions = retryable_exceptions\n            \n            retry_mechanism = RetryMechanism(config)\n            \n            return await retry_mechanism.execute_async(\n                func, *args,\n                operation_name=operation_name or func.__name__,\n                **kwargs\n            )\n\n# In original files, replace with:\nfrom src.utils.retry_mechanism_utils import wrapper"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _init_markdown_tables, _init_database, _init_database, _init_memory_db are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/enhanced_memory_manager.py",
          "src/memory_manager.py",
          "src/project_state_manager.py",
          "src/markdown_reference_system.py"
        ],
        "differences": [
          "Different signatures: _init_markdown_tables(self), _init_memory_db(self), _init_database(self)",
          "Different function calls: dirname, makedirs, info, close, cursor"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _resolve_markdown_reference, handle_options are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/app_factory.py",
          "src/markdown_reference_system.py"
        ],
        "differences": [
          "Different signatures: handle_options(path), _resolve_markdown_reference(self, reference, source_file, all_files)",
          "Varying complexity: 1-5",
          "Different function calls: options, str, Path"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_prompt, get_raw are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/prompt_manager.py"
        ],
        "differences": [
          "Different signatures: get_raw(self, prompt_key), get_prompt(prompt_key)",
          "Different function calls: _try_fallbacks, get, KeyError"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__, __init__ are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/config.py",
          "src/secure_command_executor.py",
          "src/prompt_manager.py"
        ],
        "differences": [
          "Different signatures: __init__(self), __init__(self, config_dir), __init__(self, prompts_dir)",
          "Different function calls: _load_configuration, str, home, cwd, Environment, load_all_prompts, FileSystemLoader"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _filtered_yaml_dump, _filtered_yaml_safe_dump are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/config.py"
        ],
        "differences": [
          "Different signatures: _filtered_yaml_safe_dump(data, stream), _filtered_yaml_dump(data, stream)",
          "Different function calls: _original_yaml_safe_dump, _original_yaml_dump"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_redis_config, get_redis_config are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/config.py",
          "backend/models/settings.py"
        ],
        "differences": [
          "Different signatures: get_redis_config(), get_redis_config(self)",
          "Different function calls: get_redis_config"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions reload_config, reload are 99% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/config.py"
        ],
        "differences": [
          "Different signatures: reload(self), reload_config()",
          "Different function calls: reload, _load_configuration"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_llm_config, get_backend_config are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/config.py"
        ],
        "differences": [
          "Different signatures: get_llm_config(self), get_backend_config(self)",
          "Different function calls: info, get_nested, _get_default_ollama_model, set_nested"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions update_llm_model, update_embedding_model are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/config.py"
        ],
        "differences": [
          "Different signatures: update_llm_model(self, model_name), update_embedding_model(self, model_name)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__ are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/llm_interface_extended.py",
          "src/intelligence/os_detector.py"
        ],
        "differences": [
          "Different function calls: VLLMModelManager, super, info, _initialize_vllm_models, __init__"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _handle_ollama_request, _handle_openai_request are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/llm_interface_extended.py"
        ],
        "example_refactoring": "# In src/utils/llm_interface_extended_utils.py:\n    async def _handle_ollama_request(\n        self, \n        messages: List[Dict[str, str]], \n        model_name: str, \n        **kwargs\n    ) -> Dict[str, Any]:\n        \"\"\"Handle request using Ollama (parent implementation)\"\"\"\n        # Use parent implementation for Ollama\n        return await super().chat_completion(messages, **kwargs)\n\n# In original files, replace with:\nfrom src.utils.llm_interface_extended_utils import _handle_ollama_request"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions cleanup, cleanup, cleanup are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/llm_interface_extended.py",
          "src/llm_providers/vllm_provider.py",
          "src/agents/agent_client.py"
        ],
        "differences": [
          "Different function calls: cleanup_all, warning, error, info, destroy_model_parallel, close"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__, __init__, __init__, __init__, get_full_config are 90% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/containerized_librarian_assistant.py",
          "src/agents/librarian_assistant_agent.py",
          "src/diagnostics.py",
          "src/llm_interface.py",
          "backend/services/config_service.py",
          "src/agents/kb_librarian_agent.py"
        ],
        "differences": [
          "Different signatures: __init__(self), get_full_config()",
          "Varying complexity: 1-4",
          "Different function calls: getenv, _load_reliability_stats, get, _load_prompt_from_file, str, get_llm_config, _load_composite_prompt, warning, print, nvmlInit, KnowledgeBase, LLMInterface, error"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions log_success, hello_world, get_version are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "backend/app_factory.py",
          "src/diagnostics.py"
        ],
        "example_refactoring": "# In src/utils/diagnostics_utils.py:\n    async def log_success(self, task_info: Dict[str, Any]):\n        if not self.diagnostics_enabled:\n            return\n        task_type = task_info.get(\"type\", \"unknown_task\")\n        self.reliability_stats[task_type][\"successes\"] += 1\n        self._save_reliability_stats()\n\n# In original files, replace with:\nfrom src.utils.diagnostics_utils import log_success"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions request_user_permission, _handle_command_approval are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/orchestrator.py",
          "src/diagnostics.py"
        ],
        "differences": [
          "Different signatures: _handle_command_approval(self, result), request_user_permission(self, report)",
          "Varying complexity: 3-6",
          "Different function calls: dumps, time, pop"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions set_user_permission, demo are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/chat_knowledge.py",
          "src/diagnostics.py"
        ],
        "differences": [
          "Different signatures: demo(), set_user_permission(self, task_id, granted)",
          "Different function calls: apply_knowledge_decision, get_knowledge_for_decision, ChatKnowledgeManager, set_result, create_or_update_context, add_temporary_knowledge"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions to_dict, to_dict, to_dict, to_dict are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/base_agent.py",
          "src/utils/task_queue.py",
          "src/workflow_scheduler.py"
        ],
        "differences": [
          "Varying complexity: 1-4",
          "Different function calls: asdict"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions from_dict, from_dict, from_dict are 99% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/utils/task_queue.py",
          "src/workflow_scheduler.py"
        ],
        "differences": [
          "Varying complexity: 1-7",
          "Different function calls: WorkflowPriority, TaskPriority, WorkflowStatus, TaskStatus"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions pause_queue, resume_queue are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/workflow_scheduler.py"
        ],
        "example_refactoring": "# In src/utils/workflow_scheduler_utils.py:\n    def pause_queue(self) -> None:\n        \"\"\"Pause workflow processing\"\"\"\n        self._paused = True\n\n# In original files, replace with:\nfrom src.utils.workflow_scheduler_utils import pause_queue"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions list_queued, list_running are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/workflow_scheduler.py"
        ],
        "differences": [
          "Different signatures: list_running(self), list_queued(self)",
          "Different function calls: sorted, values, list"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions start, start are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/worker_node.py",
          "src/workflow_scheduler.py"
        ],
        "differences": [
          "Different function calls: create_task, _scheduler_loop, report_capabilities, print, listen_for_tasks"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _identify_change_regions, _detect_ui_elements are 99% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/computer_vision_system.py",
          "src/multimodal_processor.py"
        ],
        "differences": [
          "Different signatures: _identify_change_regions(self, diff_image), _detect_ui_elements(self, cv_image)",
          "Different function calls: Canny, arcLength, threshold, mean"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _matches_button_criteria, _matches_checkbox_criteria are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/computer_vision_system.py"
        ],
        "example_refactoring": "# In src/utils/computer_vision_system_utils.py:\n    def _matches_button_criteria(self, aspect_ratio: float, area: int, region: np.ndarray) -> bool:\n        \"\"\"Check if element matches button criteria\"\"\"\n        rules = self.classification_rules[\"button\"]\n        \n        if not (rules[\"aspect_ratio_range\"][0] <= aspect_ratio <= rules[\"aspect_ratio_range\"][1]):\n            return False\n        \n        if not (rules[\"min_area\"] <= area <= rules[\"max_area\"]):\n            return False\n        \n        return True\n\n# In original files, replace with:\nfrom src.utils.computer_vision_system_utils import _matches_button_criteria"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__, __init__ are 92% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/enhanced_security_layer.py",
          "src/agents/agent_client.py",
          "src/security_layer.py"
        ],
        "differences": [
          "Different signatures: __init__(self), __init__(self, config_dict)",
          "Different function calls: SecureCommandExecutor, DeploymentMode, getenv, dirname, makedirs, print, _create_security_policy"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _execute_system_command, _query_system_information, _list_system_services, _manage_service, _get_process_info, _terminate_process, _web_fetch, _search_knowledge_base, _store_fact, _type_text, _click_element, _bring_window_to_front, _ask_user_for_manual, _respond_conversationally are 91% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/langchain_agent_orchestrator.py"
        ],
        "differences": [
          "Different signatures: _get_process_info(self, process_input), _store_fact(self, fact_content), _type_text(self, text), _terminate_process(self, pid), _web_fetch(self, url), _ask_user_for_manual(self, program_question), _list_system_services(self, input_text), _execute_system_command(self, command), _click_element(self, image_path), _respond_conversationally(self, response_text), _query_system_information(self, input_text), _search_knowledge_base(self, query), _bring_window_to_front(self, window_title), _manage_service(self, service_action)",
          "Different function calls: get_process_info, bring_window_to_front, search_knowledge_base, store_fact, respond_conversationally, web_fetch, len, manage_service, query_system_information, execute_system_command, ask_user_for_manual, split, list_system_services, terminate_process, type_text, click_element, isdigit"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_available_tools, get_available_tools are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/langchain_agent_orchestrator.py",
          "src/tools/tool_registry.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__, __init__, __init__ are 90% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/chat_knowledge.py",
          "backend/api/workflow_automation.py",
          "src/enhanced_orchestrator.py",
          "backend/api/advanced_workflow_orchestrator.py"
        ],
        "differences": [
          "Different signatures: __init__(self), __init__(self, base_orchestrator)",
          "Different function calls: ChatHistoryManager, _initialize_intelligent_templates, info, WorkflowAutomationManager, EnhancedOrchestrator, Orchestrator, WorkflowLearningEngine, KnowledgeBase, makedirs, LLMInterface, _initialize_default_agents"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _check_step_dependencies, _check_step_dependencies are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/workflow_automation.py",
          "src/enhanced_orchestrator.py"
        ],
        "differences": [
          "Different signatures: _check_step_dependencies(self, workflow_id, step), _check_step_dependencies(self, step, completed_results)",
          "Different function calls: get"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__ are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/gui_controller_dummy.py",
          "src/system_integration.py"
        ],
        "differences": [
          "Different function calls: system"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _listen_for_worker_capabilities, startup are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/orchestrator.py"
        ],
        "differences": [
          "Different signatures: _listen_for_worker_capabilities(self), startup(self)",
          "Varying complexity: 11-14",
          "Different function calls: check_ollama_connection, subscribe, sleep, report_capabilities, time, loads, get_message, to_dict, LangChainAgentOrchestrator, create_task, hasattr, pubsub, get_os_info, dumps, unsubscribe, list, discover_tools, _listen_for_worker_capabilities, keys, close"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions pause_agent, resume_agent, report_capabilities are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/worker_node.py",
          "src/orchestrator.py"
        ],
        "differences": [
          "Different signatures: resume_agent(self), pause_agent(self), report_capabilities(self)",
          "Different function calls: dumps, detect_capabilities"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _is_debug_mode, execute_tool are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/event_manager.py",
          "src/tools/tool_registry.py"
        ],
        "differences": [
          "Different signatures: _is_debug_mode(self), execute_tool(self, tool_name, tool_args)",
          "Varying complexity: 1-17",
          "Different function calls: get_process_info, web_fetch, replace, query_system_information, execute_system_command, ask_user_for_manual, get_fact, list_system_services, terminate_process, click_element, bring_window_to_front, search_knowledge_base, store_fact, respond_conversationally, add_file_to_knowledge_base, manage_service, lower, type_text"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _process_audio, _process_video are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/multimodal_processor.py"
        ],
        "example_refactoring": "# In src/utils/multimodal_processor_utils.py:\n    async def _process_audio(self, modal_input: ModalInput) -> Dict[str, Any]:\n        \"\"\"Process audio input\"\"\"\n        return await self.audio_processor.process_audio(modal_input.content)\n\n# In original files, replace with:\nfrom src.utils.multimodal_processor_utils import _process_audio"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__, __init__ are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/enhanced_memory_manager.py",
          "src/agents/system_knowledge_manager.py",
          "backend/chat_api.py"
        ],
        "differences": [
          "Different signatures: __init__(self, chat_data_dir), __init__(self, knowledge_base), __init__(self, db_path)",
          "Different function calls: _init_database, info, EnhancedKBLibrarian"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _resolve_includes, replace_include are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/llm_interface.py"
        ],
        "differences": [
          "Different signatures: _resolve_includes(self, content, base_path), replace_include(match)",
          "Different function calls: sub"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions make_request, make_llm_request, make_openai_request are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/llm_interface.py"
        ],
        "example_refactoring": "# In src/utils/llm_interface_utils.py:\n            async def make_request():\n                return await asyncio.to_thread(\n                    requests.get, health_check_url, timeout=5\n                )\n\n# In original files, replace with:\nfrom src.utils.llm_interface_utils import make_request"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_hardware_acceleration_manager, get_knowledge_retrieval_agent, get_chat_agent, get_rag_agent are 92% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/knowledge_retrieval_agent.py",
          "src/agents/rag_agent.py",
          "src/hardware_acceleration.py",
          "src/agents/chat_agent.py"
        ],
        "differences": [
          "Different signatures: get_knowledge_retrieval_agent(), get_hardware_acceleration_manager(), get_rag_agent(), get_chat_agent()",
          "Different function calls: RAGAgent, ChatAgent, KnowledgeRetrievalAgent, HardwareAccelerationManager"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_device_status, get_gpu_status are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/monitoring.py",
          "src/hardware_acceleration.py"
        ],
        "differences": [
          "Different signatures: get_device_status(self), get_gpu_status(self)",
          "Different function calls: virtual_memory, str, enumerate, round, boot_time, cpu_percent, float"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions circuit_breaker_async, circuit_breaker_sync are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/circuit_breaker.py"
        ],
        "differences": [
          "Different signatures: circuit_breaker_async(service_name, failure_threshold, recovery_timeout, success_threshold, timeout, monitored_exceptions), circuit_breaker_sync(service_name, failure_threshold, recovery_timeout, success_threshold, timeout, monitored_exceptions)",
          "Different function calls: call_async, call_sync"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions protected_llm_call, protected_database_call, protected_network_call are 92% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/circuit_breaker.py"
        ],
        "differences": [
          "Different signatures: protected_network_call(func), protected_database_call(func), protected_llm_call(func)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _check_dangerous_patterns, _check_dangerous_patterns are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/secure_command_executor.py",
          "src/utils/command_validator.py"
        ],
        "differences": [
          "Different function calls: warning, append"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions generate_text, generate_text are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/modern_ai_integration.py"
        ],
        "differences": [
          "Different function calls: AIResponse"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _check_rate_limit, _respect_rate_limit are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/modern_ai_integration.py",
          "src/agents/advanced_web_research.py"
        ],
        "differences": [
          "Different signatures: _check_rate_limit(self), _respect_rate_limit(self, domain)",
          "Different function calls: info"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _initialize_client, _initialize_client, _initialize_client are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/modern_ai_integration.py"
        ],
        "differences": [
          "Different function calls: AsyncOpenAI, configure, AsyncAnthropic"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions analyze_image, analyze_image, analyze_image are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/modern_ai_integration.py"
        ],
        "differences": [
          "Different function calls: GenerativeModel, GenerationConfig, b64decode, create, BytesIO, open, generate_content"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions multimodal_chat, multimodal_chat, multimodal_chat, multimodal_chat are 98% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/modern_ai_integration.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions process_natural_language_goal, _handle_complex_goal, execute_with_streaming are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/intelligence/streaming_executor.py",
          "src/intelligence/intelligent_agent.py"
        ],
        "differences": [
          "Different signatures: _handle_complex_goal(self, user_input), process_natural_language_goal(self, user_input, context), execute_with_streaming(self, command, user_goal, timeout, provide_commentary)",
          "Varying complexity: 7-15",
          "Different function calls: len, _handle_complex_goal, _parse_llm_commands, _stream_process_output, create_subprocess_exec, split, get_similar_intents, time, is_command_safe, select_tool, append, ProcessInfo, kill, terminate, uuid4, get, generate_response, process_goal, enumerate, wait_for, execute_with_streaming, _build_llm_system_prompt, info, wait, error, _provide_completion_commentary, _install_tool"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions kill_process, kill_process are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/intelligence/streaming_executor.py",
          "src/intelligence/intelligent_agent.py"
        ],
        "differences": [
          "Different function calls: wait_for, kill_process, terminate, info, wait, error, kill"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions read_stdout, read_stderr are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/intelligence/streaming_executor.py"
        ],
        "differences": [
          "Different signatures: read_stderr(), read_stdout()",
          "Different function calls: len, _provide_progress_commentary"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_resource_summary, _aggregate_resource_usage are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/metrics/system_monitor.py",
          "src/metrics/workflow_metrics.py"
        ],
        "differences": [
          "Different signatures: _aggregate_resource_usage(self, snapshots), get_resource_summary(self, minutes)",
          "Varying complexity: 3-10",
          "Different function calls: min, fromisoformat, str, timestamp, now, reversed, append"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions task, task are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/utils/task_queue.py"
        ],
        "differences": [
          "Different signatures: task(name), task(self, name)",
          "Different function calls: get_task_queue, update, copy, enqueue"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_redis_config, get_redis_config are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/services/config_service.py",
          "src/utils/redis_client.py"
        ],
        "differences": [
          "Different function calls: error, str"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions query_system_information, list_system_services, get_process_info, ask_user_for_manual are 90% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/tools/tool_registry.py"
        ],
        "differences": [
          "Different signatures: list_system_services(self), query_system_information(self), ask_user_for_manual(self, program_name, question_text), get_process_info(self, process_name, pid)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions bring_window_to_front, respond_conversationally are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/tools/tool_registry.py"
        ],
        "differences": [
          "Different signatures: bring_window_to_front(self, window_title), respond_conversationally(self, response_text)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _extract_detailed_examples, _extract_instructions, _extract_install_commands are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/enhanced_kb_librarian.py",
          "src/agents/security_scanner_agent.py"
        ],
        "differences": [
          "Different signatures: _extract_install_commands(self, guide_text), _extract_instructions(self, results, tool_name), _extract_detailed_examples(self, text)",
          "Varying complexity: 5-17",
          "Different function calls: lower, get"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _extract_advanced_features, _extract_error_codes are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/enhanced_kb_librarian.py"
        ],
        "differences": [
          "Different signatures: _extract_advanced_features(self, text), _extract_error_codes(self, text)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _format_command_examples, _format_procedures, _format_troubleshooting, _format_documentation_examples, _format_tool_requirements, _format_workflow_steps, _format_decision_points, _format_pitfalls, _format_alternatives are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/enhanced_kb_librarian.py"
        ],
        "differences": [
          "Different signatures: _format_pitfalls(self, pitfalls), _format_command_examples(self, examples), _format_workflow_steps(self, steps), _format_alternatives(self, alternatives), _format_tool_requirements(self, tools), _format_documentation_examples(self, examples), _format_procedures(self, procedures), _format_troubleshooting(self, issues), _format_decision_points(self, decisions)",
          "Varying complexity: 4-8",
          "Different function calls: enumerate"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _format_best_practices, _format_prerequisites are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/enhanced_kb_librarian.py"
        ],
        "differences": [
          "Different signatures: _format_prerequisites(self, prereqs), _format_best_practices(self, practices)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions execute, execute are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/network_discovery_agent.py",
          "src/agents/security_scanner_agent.py"
        ],
        "differences": [
          "Different function calls: _service_detection, _create_network_map, _asset_inventory, _network_scan, _dns_enumeration, _host_discovery, _validate_target, _vulnerability_scan, _arp_scan, _ssl_scan, _port_scan, _web_scan, _traceroute"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _parse_arp_scan, _parse_nmap_output, _parse_nmap_output, _parse_nmap_services are 92% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/network_discovery_agent.py",
          "src/agents/security_scanner_agent.py"
        ],
        "differences": [
          "Different signatures: _parse_nmap_output(self, output), _parse_arp_scan(self, output), _parse_nmap_services(self, output)",
          "Different function calls: ip_address, join"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _detect_sudo_prompt, _detect_input_prompt are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/interactive_terminal_agent.py"
        ],
        "example_refactoring": "# In src/utils/interactive_terminal_agent_utils.py:\n    def _detect_sudo_prompt(self, output: str) -> bool:\n        \"\"\"Detect sudo password prompts\"\"\"\n        sudo_patterns = [\n            \"[sudo] password\",\n            \"Password:\",\n            \"password for\",\n            \"[sudo] password for\",\n        ]\n        return any(pattern in output for pattern in sudo_patterns)\n\n# In original files, replace with:\nfrom src.utils.interactive_terminal_agent_utils import _detect_sudo_prompt"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _handle_sudo_prompt, _handle_input_prompt are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/interactive_terminal_agent.py"
        ],
        "differences": [
          "Different signatures: _handle_sudo_prompt(self, prompt_data), _handle_input_prompt(self, prompt_data)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_active_sessions, get_active_sessions, get_active_sessions are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/system_command_agent.py",
          "backend/api/terminal.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: get_active_sessions(self), get_active_sessions()",
          "Different function calls: HTTPException, get, JSONResponse, str, items, append, get_active_sessions, error"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions take_control_of_session, return_control_of_session are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/system_command_agent.py"
        ],
        "differences": [
          "Different signatures: return_control_of_session(self, chat_id), take_control_of_session(self, chat_id)",
          "Different function calls: take_control, return_control"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_librarian_assistant, get_kb_librarian, get_containerized_librarian_assistant are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/containerized_librarian_assistant.py",
          "src/agents/librarian_assistant_agent.py",
          "src/agents/kb_librarian_agent.py"
        ],
        "differences": [
          "Different signatures: get_containerized_librarian_assistant(), get_kb_librarian(), get_librarian_assistant()",
          "Different function calls: ContainerizedLibrarianAssistant, LibrarianAssistantAgent, KBLibrarianAgent"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _extract_duckduckgo_results, _extract_bing_results, _extract_google_results are 99% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/librarian_assistant_agent.py"
        ],
        "differences": [
          "Different signatures: _extract_google_results(self, page), _extract_duckduckgo_results(self, page), _extract_bing_results(self, page)",
          "Different function calls: startswith"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions research_query, research_query are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/containerized_librarian_assistant.py",
          "src/agents/librarian_assistant_agent.py"
        ],
        "example_refactoring": "# In src/utils/librarian_assistant_agent_utils.py:\n    async def research_query(\n        self, query: str, store_quality_content: bool = None\n    ) -> Dict[str, Any]:\n        \"\"\"Research a query by searching the web and extracting content.\n\n        Args:\n            query: Research query\n            store_quality_content: Whether to auto-store quality content\n\n        Returns:\n            Research results with sources and assessments\n        \"\"\"\n        if not self.enabled:\n            return {\"enabled\": False, \"message\": \"Librarian Assistant is disabled\"}\n\n        if store_quality_content is None:\n            store_quality_content = self.auto_store_quality\n\n        research_results = {\n            \"query\": query,\n            \"timestamp\": datetime.now().isoformat(),\n            \"search_results\": [],\n            \"content_extracted\": [],\n            \"stored_in_kb\": [],\n            \"summary\": \"\",\n            \"sources\": [],\n        }\n\n        try:\n            # Step 1: Search for relevant URLs\n            logger.info(f\"Researching query: {query}\")\n            search_results = await self.search_web(query)\n            research_results[\"search_results\"] = search_results\n\n            if not search_results:\n                research_results[\"summary\"] = \"No search results found for the query.\"\n                return research_results\n\n            # Step 2: Extract content from top results\n            extracted_content = []\n            for result in search_results[\n                :3\n            ]:  # Limit to top 3 results for detailed extraction\n                content = await self.extract_content(result[\"url\"])\n                if content:\n                    # Assess content quality\n                    assessment = await self.assess_content_quality(content)\n                    content[\"quality_assessment\"] = assessment\n\n                    extracted_content.append(content)\n\n                    # Store high-quality content if enabled\n                    if (\n                        store_quality_content\n                        and assessment.get(\"score\", 0) >= self.quality_threshold\n                        and assessment.get(\"recommendation\") == \"store\"\n                    ):\n                        stored = await self.store_in_knowledge_base(content, assessment)\n                        if stored:\n                            research_results[\"stored_in_kb\"].append(\n                                {\n                                    \"url\": content[\"url\"],\n                                    \"title\": content[\"title\"],\n                                    \"quality_score\": assessment.get(\"score\", 0),\n                                }\n                            )\n\n            research_results[\"content_extracted\"] = extracted_content\n\n            # Step 3: Create summary with sources\n            if extracted_content:\n                summary = await self._create_research_summary(query, extracted_content)\n                research_results[\"summary\"] = summary\n\n                # Collect sources\n                sources = []\n                for content in extracted_content:\n                    sources.append(\n                        {\n                            \"title\": content[\"title\"],\n                            \"url\": content[\"url\"],\n                            \"domain\": content[\"domain\"],\n                            \"is_trusted\": content[\"is_trusted\"],\n                            \"quality_score\": content.get(\"quality_assessment\", {}).get(\n                                \"score\", 0\n                            ),\n                        }\n                    )\n                research_results[\"sources\"] = sources\n\n            logger.info(\n                f\"Research completed: {len(extracted_content)} sources analyzed, \"\n                f\"{len(research_results['stored_in_kb'])} stored in KB\"\n            )\n\n        except Exception as e:\n            logger.error(f\"Error during research: {e}\")\n            research_results[\"error\"] = str(e)\n        finally:\n            # Clean up Playwright resources\n            await self._cleanup_playwright()\n\n        return research_results\n\n# In original files, replace with:\nfrom src.utils.librarian_assistant_agent_utils import research_query"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__, __init__ are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/chat_agent.py",
          "src/agents/enhanced_system_commands_agent.py",
          "src/agents/rag_agent.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions process_request, process_request, process_request, process_request, process_request, process_request are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/enhanced_system_commands_agent.py",
          "src/agents/agent_client.py",
          "src/agents/chat_agent.py",
          "src/agents/rag_agent.py",
          "src/agents/classification_agent.py"
        ],
        "differences": [
          "Different function calls: get_agent, process_command_request, process_chat_message, classify_request, update_agent_health, deserialize_agent_response, validate_command_safety, time, _execute_with_retries, process_document_query, ClientTimeout, text, post, get, _update_stats, reformulate_query, error, rank_documents, serialize_agent_request"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _extract_response_content, _extract_response_content, _extract_response_content, _extract_response_content, _extract_response_content are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/enhanced_system_commands_agent.py",
          "src/agents/agent_orchestrator.py",
          "src/agents/knowledge_retrieval_agent.py",
          "src/agents/chat_agent.py",
          "src/agents/rag_agent.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions is_system_command_request, is_knowledge_retrieval_appropriate, is_chat_appropriate are 91% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/knowledge_retrieval_agent.py",
          "src/agents/enhanced_system_commands_agent.py",
          "src/agents/chat_agent.py"
        ],
        "differences": [
          "Different signatures: is_system_command_request(self, message), is_knowledge_retrieval_appropriate(self, message), is_chat_appropriate(self, message)",
          "Varying complexity: 1-5",
          "Different function calls: _is_question, len, split"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _search_duckduckgo, _search_bing, _search_google are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/advanced_web_research.py"
        ],
        "differences": [
          "Different signatures: _search_google(self, query, max_results), _search_bing(self, query, max_results), _search_duckduckgo(self, query, max_results)",
          "Varying complexity: 7-11",
          "Different function calls: evaluate, wait_for_timeout, click"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _calculate_quality_score, _calculate_quality_score are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/web_research_assistant.py",
          "src/agents/advanced_web_research.py"
        ],
        "differences": [
          "Different signatures: _calculate_quality_score(self, result), _calculate_quality_score(self, result, query)",
          "Different function calls: sum, split"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions close, __aexit__ are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/advanced_web_research.py"
        ],
        "differences": [
          "Different signatures: close(self), __aexit__(self, exc_type, exc_val, exc_tb)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _get_routing_system_prompt, _get_chat_system_prompt, _get_rag_system_prompt, _get_query_reformulation_prompt are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/chat_agent.py",
          "src/agents/rag_agent.py",
          "src/agents/agent_orchestrator.py"
        ],
        "differences": [
          "Different signatures: _get_chat_system_prompt(self), _get_routing_system_prompt(self), _get_rag_system_prompt(self), _get_query_reformulation_prompt(self)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _import_tools_knowledge, _import_workflows_knowledge, _import_procedures_knowledge are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/system_knowledge_manager.py"
        ],
        "differences": [
          "Different signatures: _import_workflows_knowledge(self), _import_procedures_knowledge(self), _import_tools_knowledge(self)",
          "Different function calls: get, _import_single_workflow, _import_single_procedure, _import_single_tool"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _format_pitfalls, _format_procedure_issues are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "src/agents/system_knowledge_manager.py"
        ],
        "differences": [
          "Different signatures: _format_pitfalls(self, pitfalls_data), _format_procedure_issues(self, issues_data)"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions _get_nmap_content, _get_forensics_content are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "src/agents/web_research_assistant.py"
        ],
        "example_refactoring": "# In src/utils/web_research_assistant_utils.py:\n    def _get_nmap_content(self) -> str:\n        \"\"\"Mock nmap content\"\"\"\n        return \"\"\"\n        Nmap (Network Mapper) is a powerful network discovery and \\\nsecurity auditing tool.\n\n        Installation:\n        - Ubuntu/Debian: sudo apt-get install nmap\n        - CentOS/RHEL: sudo yum install nmap\n        - Arch: sudo pacman -S nmap\n\n        Basic Usage:\n        - nmap target - Basic scan\n        - nmap -sS target - SYN scan (stealth)\n        - nmap -sV target - Service version detection\n        - nmap -O target - OS detection\n        - nmap -A target - Aggressive scan\n\n        Common Options:\n        - -p: Specify ports (e.g., -p 80,443 or -p-)\n        - -sU: UDP scan\n        - -T: Timing template (0-5)\n        - -oA: Output in all formats\n\n        Advanced Features:\n        - NSE scripts for vulnerability detection\n        - Firewall evasion techniques\n        - Custom packet crafting\n        \"\"\"\n\n# In original files, replace with:\nfrom src.utils.web_research_assistant_utils import _get_nmap_content"
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions add_security_headers, not_found_handler, method_not_allowed_handler are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "backend/app_factory.py"
        ],
        "example_refactoring": "# In src/utils/app_factory_utils.py:\n    async def add_security_headers(request, call_next):\n        response = await call_next(request)\n\n        # Remove potentially problematic headers\n        headers_to_remove = [\n            \"content-security-policy\",\n            \"x-xss-protection\",\n            \"X-Frame-Options\",\n            \"Expires\",\n        ]\n        for header in headers_to_remove:\n            if header in response.headers:\n                del response.headers[header]\n\n        # Add security headers\n        response.headers[\"X-Content-Type-Options\"] = \"nosniff\"\n        response.headers[\"Cache-Control\"] = \"no-cache, no-store, must-revalidate\"\n\n        return response\n\n# In original files, replace with:\nfrom src.utils.app_factory_utils import add_security_headers"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _create_smart_development_environment_template, _create_intelligent_security_hardening_template, _create_adaptive_deployment_template, _create_predictive_maintenance_template, _create_ai_backup_strategy_template are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/advanced_workflow_orchestrator.py"
        ],
        "differences": [
          "Different signatures: _create_predictive_maintenance_template(self), _create_adaptive_deployment_template(self), _create_intelligent_security_hardening_template(self), _create_ai_backup_strategy_template(self), _create_smart_development_environment_template(self)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _generate_validation_command, _generate_rollback_command are 97% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/advanced_workflow_orchestrator.py"
        ],
        "differences": [
          "Different signatures: _generate_rollback_command(self, command), _generate_validation_command(self, command)",
          "Varying complexity: 4-7"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions __init__, __init__ are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/secure_terminal_websocket.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: __init__(self, session_id), __init__(self, session_id, security_layer, user_role)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions connect, connect are 100% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/secure_terminal_websocket.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": [
          "Different function calls: info"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions start_pty_shell, start_pty_shell are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "backend/api/secure_terminal_websocket.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "example_refactoring": "# In src/utils/secure_terminal_websocket_utils.py:\n    async def start_pty_shell(self):\n        \"\"\"Start a PTY shell process for full interactivity\"\"\"\n        try:\n            master_fd, slave_fd = pty.openpty()\n            self.pty_fd = master_fd\n\n            self.process = subprocess.Popen(\n                ['/bin/bash'],\n                stdin=slave_fd,\n                stdout=slave_fd,\n                stderr=slave_fd,\n                cwd=self.current_dir,\n                env=self.env,\n                preexec_fn=os.setsid\n            )\n\n            os.close(slave_fd)  # Close slave_fd in parent process\n\n            # Start reader thread\n            self.reader_thread = threading.Thread(\n                target=self._read_pty_output,\n                daemon=True\n            )\n            self.reader_thread.start()\n\n            logger.info(f\"Secure PTY shell started for session {self.session_id}\")\n\n        except Exception as e:\n            logger.error(f\"Failed to start PTY shell: {e}\")\n            await self.send_message({\n                \"type\": \"error\",\n                \"message\": f\"Failed to start secure terminal: {str(e)}\"\n            })\n\n# In original files, replace with:\nfrom src.utils.secure_terminal_websocket_utils import start_pty_shell"
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions execute_command, execute_command are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/secure_terminal_websocket.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions send_message, send_message are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/secure_terminal_websocket.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: send_message(self, data), send_message(self, message)"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions disconnect, disconnect are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/secure_terminal_websocket.py",
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": [
          "Different function calls: audit_log, is_alive, join"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions start_system_monitoring, stop_system_monitoring are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/metrics.py"
        ],
        "differences": [
          "Different signatures: start_system_monitoring(), stop_system_monitoring()",
          "Different function calls: stop_monitoring, start_monitoring"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions save_prompt, revert_prompt are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/prompts.py"
        ],
        "differences": [
          "Different signatures: revert_prompt(prompt_id), save_prompt(prompt_id, request)",
          "Different function calls: exists, warning, get, read"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions update_llm_config, update_redis_config are 94% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/redis.py",
          "backend/api/llm.py"
        ],
        "differences": [
          "Different signatures: update_llm_config(config_data), update_redis_config(config_data)",
          "Different function calls: update_llm_config, update_redis_config"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions update_llm_provider, update_embedding_model are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/llm.py"
        ],
        "differences": [
          "Different signatures: update_llm_provider(provider_data), update_embedding_model(embedding_data)",
          "Varying complexity: 6-9",
          "Different function calls: save_settings, update_embedding_model, update_llm_model, get_nested"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_knowledge_stats, get_detailed_knowledge_stats are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/knowledge.py"
        ],
        "differences": [
          "Different signatures: get_detailed_knowledge_stats(), get_knowledge_stats()",
          "Different function calls: get_stats, get_detailed_stats"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions import_system_documentation, import_system_prompts are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/knowledge.py"
        ],
        "differences": [
          "Different signatures: import_system_documentation(), import_system_prompts()"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions pause_agent_api, resume_agent_api are 99% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/agent.py"
        ],
        "differences": [
          "Different signatures: resume_agent_api(request, user_role), pause_agent_api(request, user_role)",
          "Different function calls: pause_agent, resume_agent"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_backend_settings, save_backend_settings are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/settings.py"
        ],
        "differences": [
          "Different signatures: get_backend_settings(), save_backend_settings(backend_settings)",
          "Different function calls: get_backend_settings, get, update_backend_settings, post"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _extract_text_from_complex_json, extract_recursive are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/chat.py"
        ],
        "differences": [
          "Different signatures: _extract_text_from_complex_json(data, max_length), extract_recursive(obj, depth)",
          "Different function calls: join"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_chat, delete_chat are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/chat.py"
        ],
        "differences": [
          "Different signatures: delete_chat(chat_id, request), get_chat(chat_id, request)",
          "Varying complexity: 4-10",
          "Different function calls: list_sessions, load_session, delete, delete_session, warning, getattr"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions websocket_terminal, websocket_simple_terminal, websocket_secure_terminal, simple_terminal_websocket_endpoint, terminal_websocket_endpoint are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal.py",
          "backend/api/simple_terminal_websocket.py",
          "backend/api/terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: websocket_simple_terminal(websocket, session_id), terminal_websocket_endpoint(websocket, chat_id), simple_terminal_websocket_endpoint(websocket, session_id), websocket_secure_terminal(websocket, session_id), websocket_terminal(websocket, chat_id)",
          "Different function calls: terminal_websocket_endpoint, handle_terminal_session, handle_secure_terminal_websocket, websocket, getattr, handle_connection, simple_terminal_websocket_endpoint"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions create_session, create_terminal_session are 98% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal.py"
        ],
        "differences": [
          "Different signatures: create_terminal_session(), create_session(request)",
          "Different function calls: info"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_sessions, get_simple_sessions are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal.py"
        ],
        "differences": [
          "Different signatures: get_sessions(), get_simple_sessions()",
          "Different function calls: get_active_sessions"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions get_session_info, get_session_info are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal.py"
        ],
        "differences": []
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions close_session, delete_terminal_session are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal.py"
        ],
        "differences": [
          "Different signatures: delete_terminal_session(session_id), close_session(session_id)",
          "Different function calls: info"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions send_terminal_input, send_terminal_signal are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal.py"
        ],
        "differences": [
          "Different signatures: send_terminal_signal(chat_id, signal_type), send_terminal_input(chat_id, request)",
          "Different function calls: send_signal_to_session, send_input_to_session"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions handle_workflow_control, handle_workflow_message are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/simple_terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: handle_workflow_message(self, data), handle_workflow_control(self, data)",
          "Varying complexity: 8-12",
          "Different function calls: info, execute_command"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions pause_takeover_session, resume_takeover_session are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/advanced_control.py"
        ],
        "differences": [
          "Different signatures: resume_takeover_session(session_id), pause_takeover_session(session_id)",
          "Different function calls: resume_takeover_session, pause_takeover_session"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _send_message, _send_error are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: _send_error(self, websocket, error), _send_message(self, websocket, message)",
          "Different function calls: dumps, error, send_text, _send_message"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions _subscribe_to_terminal_events, handle_terminal_output, handle_terminal_control, handle_terminal_session, handle_command_execution, handle_command_confirmation are 95% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/terminal_websocket.py"
        ],
        "differences": [
          "Different signatures: handle_command_confirmation(event_data), handle_terminal_control(event_data), _subscribe_to_terminal_events(self, chat_id, websocket), handle_command_execution(event_data), handle_terminal_output(event_data), handle_terminal_session(event_data)",
          "Varying complexity: 2-7",
          "Different function calls: sleep, unsubscribe, subscribe"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions voice_listen_api, voice_speak_api are 96% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/api/voice.py"
        ],
        "differences": [
          "Different signatures: voice_listen_api(request, user_role), voice_speak_api(request, text, user_role)",
          "Different function calls: listen_and_convert_to_text, speak_text"
        ]
      },
      {
        "type": "similar_functions",
        "priority": "medium",
        "description": "Functions test_ollama_connection, test_redis_connection are 93% similar",
        "action": "Extract common logic to base function with parameters",
        "affected_files": [
          "backend/utils/connection_utils.py"
        ],
        "differences": [
          "Different signatures: test_ollama_connection(), test_redis_connection()",
          "Different function calls: json, hasattr, any, get_redis_client, replace, post, module_list, isinstance, int, ping, get_nested"
        ]
      },
      {
        "type": "exact_duplicate",
        "priority": "high",
        "description": "Functions validate_port, validate_port, validate_transport are exact duplicates",
        "action": "Create a shared utility function in src/utils/",
        "affected_files": [
          "backend/models/settings.py"
        ],
        "example_refactoring": "# In src/utils/settings_utils.py:\n    def validate_port(cls, v):\n        if not 1 <= v <= 65535:\n            raise ValueError('Port must be between 1 and 65535')\n        return v\n\n# In original files, replace with:\nfrom src.utils.settings_utils import validate_port"
      }
    ],
    "metrics": {
      "total_lines_of_code": 46637,
      "duplicate_lines": 7368,
      "duplication_percentage": 15.798614833715718,
      "average_function_length": 27.337045720984758,
      "average_complexity": 3.614888628370457,
      "functions_by_complexity": {
        "low": 1390,
        "medium": 248,
        "high": 68
      }
    }
  },
  "command_duplicates": [
    {
      "similarity_score": 1.0,
      "refactoring_suggestion": "Extract to shared utility function",
      "estimated_lines_saved": 25,
      "functions": [
        {
          "file": "src/agents/network_discovery_agent.py",
          "name": "_run_command",
          "line_range": "368-393",
          "signature": "_run_command(self, cmd, timeout)",
          "complexity": 4
        },
        {
          "file": "src/agents/security_scanner_agent.py",
          "name": "_run_command",
          "line_range": "344-369",
          "signature": "_run_command(self, cmd, timeout)",
          "complexity": 4
        }
      ]
    },
    {
      "similarity_score": 0.9399337098471929,
      "refactoring_suggestion": "Consider extracting common logic",
      "estimated_lines_saved": 14,
      "functions": [
        {
          "file": "backend/api/secure_terminal_websocket.py",
          "name": "execute_command",
          "line_range": "219-236",
          "signature": "execute_command(self, command)",
          "complexity": 3
        },
        {
          "file": "backend/api/simple_terminal_websocket.py",
          "name": "execute_command",
          "line_range": "155-172",
          "signature": "execute_command(self, command)",
          "complexity": 3
        }
      ]
    }
  ],
  "refactoring_plan": {
    "phase1": {
      "title": "Consolidate Basic Command Execution",
      "actions": [
        "1. Keep src/utils/command_utils.py as the base implementation",
        "2. Update src/command_executor.py to use command_utils directly",
        "3. Remove duplicate _run_command from agents (use command_utils instead)"
      ]
    },
    "phase2": {
      "title": "Create Command Execution Hierarchy",
      "actions": [
        "1. Base: src/utils/command_utils.py - Basic async command execution",
        "2. Secure: src/secure_command_executor.py - Add security checks",
        "3. Elevated: src/elevation_wrapper.py - Add sudo/elevation support"
      ]
    },
    "phase3": {
      "title": "Standardize Return Format",
      "actions": [
        "1. Use consistent format: {stdout, stderr, return_code, status}",
        "2. Add optional fields: {execution_time, security_metadata}",
        "3. Update all callers to use new format"
      ]
    }
  }
}