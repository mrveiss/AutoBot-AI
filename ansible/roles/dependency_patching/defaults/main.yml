# AutoBot - AI-Powered Automation Platform
# Copyright (c) 2025 mrveiss
# Author: mrveiss
---
# Dependency Patching Role - Default Variables
# Issue #682: Ansible Rolling Update System for Dependency Patching

# Backup settings
backup_enabled: true
backup_retention_days: 7
backup_base_path: "/opt/autobot/backups"

# Update behavior
dry_run: false
force_update: false
update_timeout: 300  # seconds per package batch

# Health check settings
health_check_enabled: true
health_check_retries: 10
health_check_delay: 5  # seconds between retries
health_check_timeout: 60

# Rollback settings
rollback_on_failure: true
rollback_timeout: 120

# Service drain settings (for graceful shutdown)
drain_enabled: true
drain_timeout: 60  # seconds to wait for connections to drain

# Python venv settings
venv_path: "/opt/autobot/venv"
requirements_path: "/opt/autobot/requirements.txt"
pip_extra_args: "--no-cache-dir"

# Packages to update (CVE fixes from Issue #544)
# Format: package_name: minimum_version
python_security_updates:
  filelock: "3.20.1"
  keras: "3.12.0"
  langchain-core: "0.3.81"
  markdownify: "0.14.1"
  marshmallow: "3.26.2"
  pypdf: "6.4.0"
  starlette: "0.49.1"
  urllib3: "2.6.0"
  werkzeug: "3.1.4"
  requests: "2.32.4"

# Service restart after update
restart_service_after_update: true
service_restart_delay: 5  # seconds to wait after restart before health check

# System package (apt) update settings
security_only: false  # Only apply security updates
reboot_if_required: false  # Reboot automatically if kernel updated
system_update_timeout: 600  # seconds for apt upgrade to complete
