#!/bin/bash
# AutoBot - AI-Powered Automation Platform
# Copyright (c) 2025 mrveiss
# Author: mrveiss
#
# Show AutoBot fleet DNS entries
# Generated by Ansible - DO NOT EDIT MANUALLY

echo "ğŸ” AutoBot Fleet DNS Entries"
echo "============================="
echo ""

echo "ğŸ“‹ /etc/hosts Fleet Entries:"
echo "----------------------------"
if grep -q "{{ hosts_marker_begin }}" /etc/hosts 2>/dev/null; then
    sed -n '/{{ hosts_marker_begin }}/,/{{ hosts_marker_end }}/p' /etc/hosts | grep -v "^#" | grep -v "^$"
else
    echo "No AutoBot entries found in /etc/hosts"
fi

echo ""
echo "ğŸŒ Fleet Node Mappings:"
echo "----------------------"
{% for entry in fleet_host_entries %}
printf "%-30s â†’ %s\n" "{{ entry.hostname }}" "{{ entry.ip }}"
{% endfor %}

echo ""
echo "ğŸ”§ DNS Configuration:"
echo "--------------------"
{% if install_dnsmasq %}
echo "DNS Cache: dnsmasq ({{ dnsmasq_listen_address }}:{{ dnsmasq_port }})"
echo "Cache Size: {{ dnsmasq_cache_size }} entries"
{% elif use_systemd_resolved %}
echo "DNS Cache: systemd-resolved"
{% else %}
echo "DNS Cache: None"
{% endif %}

echo "Domain: {{ dns_domain }}"
echo "Search Domains: {{ dns_search_domains | join(', ') }}"

echo ""
echo "ğŸ“Š Current DNS Servers:"
echo "----------------------"
{% if install_dnsmasq %}
echo "Primary: {{ dnsmasq_listen_address }} (dnsmasq)"
{% endif %}
cat /etc/resolv.conf | grep "^nameserver" | awk '{print $2}'
