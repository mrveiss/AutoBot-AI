#!/bin/bash
# AutoBot - AI-Powered Automation Platform
# Copyright (c) 2025 mrveiss
# Author: mrveiss
#
# Access Control Status Script
# Generated by Ansible - DO NOT EDIT MANUALLY

echo "ðŸ”’ AutoBot Access Control Status"
echo "================================="
echo ""

echo "Mode: {{ access_control_mode }}"
echo "Audit Logging: {{ 'Enabled' if enable_audit_logging else 'Disabled' }}"
echo "Session Validation: {{ 'Enabled' if enable_session_validation else 'Disabled' }}"
echo "Monitoring: {{ 'Enabled' if enable_access_monitoring else 'Disabled' }}"

echo ""
echo "Active Policies:"
{% for policy in access_policies %}
echo "  - {{ policy.name }}: {{ 'Enabled' if policy.enabled else 'Disabled' }} ({{ policy.enforcement_level }})"
{% endfor %}

echo ""
echo "Monitoring Service:"
systemctl status autobot-access-monitor.timer --no-pager -l 2>/dev/null || echo "  Not running"

echo ""
echo "Recent Audit Logs:"
tail -n 10 {{ logs_dir }}/audit/*.log 2>/dev/null || echo "  No audit logs found"
