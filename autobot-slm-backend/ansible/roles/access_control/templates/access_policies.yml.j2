# AutoBot Access Control Policies
# Generated by Ansible - DO NOT EDIT MANUALLY

mode: {{ access_control_mode }}
enforcement_enabled: {{ 'true' if access_control_mode == 'full' else 'false' }}

policies:
{% for policy in access_policies %}
  - name: {{ policy.name }}
    enabled: {{ policy.enabled | lower }}
    enforcement_level: {{ policy.enforcement_level }}
{% endfor %}

session_validation:
  enabled: {{ enable_session_validation | lower }}
  strict_mode: {{ session_ownership_strict_mode | lower }}
  backfill_enabled: {{ session_ownership_backfill | lower }}

audit:
  enabled: {{ enable_audit_logging | lower }}
  level: {{ audit_log_level }}
  format: {{ audit_log_format }}
  backends: {{ audit_backends | to_json }}
  rotation_days: {{ audit_log_rotation }}

legacy:
  support_enabled: {{ legacy_mode_support | lower }}
  grace_period_days: {{ grace_period_days }}

rollback:
  auto_enabled: {{ enable_auto_rollback | lower }}
  error_rate_threshold: {{ rollback_on_error_rate }}

generated_at: "{{ ansible_date_time.iso8601 }}"
