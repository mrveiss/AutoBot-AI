# AutoBot Fleet Topology Configuration
# Generated by Ansible - DO NOT EDIT MANUALLY

deployment_mode: distributed
generated_at: "{{ ansible_date_time.iso8601 }}"

coordinator:
  hostname: "{{ coordinator_host }}"
  ip: "{{ coordinator_host }}"
  port: {{ backend_port }}
  services:
    - backend-api
    - ollama
    - vnc

fleet_nodes:
{% for node in fleet_nodes %}
  - name: "{{ node.name }}"
    hostname: "{{ node.host }}"
    ip: "{{ node.host }}"
    role: "{{ node.role }}"
    port: {{ node.port }}
    health_endpoint: "{{ node.health_endpoint }}"
    ssh_access: true
{% endfor %}

network:
  internal_subnet: "172.16.168.0/24"
  coordinator_ip: "{{ coordinator_host }}"
  redis_ip: "{{ hostvars[groups['redis'][0]]['ansible_host'] if 'redis' in groups else 'N/A' }}"

capabilities:
  total_nodes: {{ fleet_nodes | length + 1 }}
  distributed_redis: {{ 'true' if 'redis' in groups else 'false' }}
  hardware_acceleration: {{ 'true' if fleet_nodes | selectattr('role', 'match', '.*npu.*') | list | length > 0 else 'false' }}
  browser_automation: {{ 'true' if fleet_nodes | selectattr('role', 'match', '.*browser.*') | list | length > 0 else 'false' }}
