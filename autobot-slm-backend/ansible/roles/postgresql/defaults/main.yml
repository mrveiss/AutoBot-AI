# AutoBot - AI-Powered Automation Platform
# Copyright (c) 2025 mrveiss
# Author: mrveiss
#
# PostgreSQL Role Defaults
---

# PostgreSQL version
postgresql_version: "16"

# APT repository release codename override
# Set this if ansible_distribution_release is not supported by pgdg
# (e.g. focal EOL, kali-rolling). Use the nearest Debian/Ubuntu LTS codename.
# Leave empty to auto-detect from ansible_distribution_release.
postgresql_apt_release: ""

# Service configuration
postgresql_service: "postgresql"
postgresql_data_dir: "/var/lib/postgresql/{{ postgresql_version }}/main"
postgresql_config_dir: "/etc/postgresql/{{ postgresql_version }}/main"

# Connection settings
postgresql_listen_addresses: "localhost"
postgresql_port: 5432
postgresql_max_connections: 100

# Memory settings (tuned for 4GB RAM VM)
postgresql_shared_buffers: "256MB"
postgresql_effective_cache_size: "1GB"
postgresql_work_mem: "16MB"
postgresql_maintenance_work_mem: "128MB"

# WAL settings
postgresql_wal_buffers: "8MB"
postgresql_min_wal_size: "1GB"
postgresql_max_wal_size: "2GB"

# Checkpoint settings
postgresql_checkpoint_completion_target: 0.9

# Logging
postgresql_log_destination: "stderr"
postgresql_logging_collector: "on"
postgresql_log_directory: "log"
postgresql_log_filename: "postgresql-%Y-%m-%d_%H%M%S.log"
postgresql_log_rotation_age: "1d"
postgresql_log_rotation_size: "100MB"

# Authentication
postgresql_password_encryption: "scram-sha-256"

# Credentials storage
postgresql_credentials_dir: "/etc/autobot"
postgresql_credentials_file: "db-credentials.env"

# Database user and databases (override per-playbook)
db_user: "slm_app"
db_host: "127.0.0.1"
db_env_prefix: "SLM"
databases:
  - slm
  - slm_users

# AutoBot user
autobot_user: "autobot"
autobot_group: "autobot"
