# Redis Optimized Configuration for AutoBot Vector Operations
# Target: 12-core VM with high-performance vector workloads

# ==================== MULTI-THREADING CONFIGURATION ====================
# Enable I/O threading to utilize multiple CPU cores
# Recommended: cores - 2 (leave 2 for system and main thread)
io-threads 10
io-threads-do-reads yes

# ==================== MEMORY OPTIMIZATION ====================
# Vector operations require significant memory
maxmemory 8gb
maxmemory-policy allkeys-lru

# ==================== PERSISTENCE CONFIGURATION ====================
# AOF for better durability of vector data
appendonly yes
appendfsync everysec
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# RDB snapshots for backup
save 900 1
save 300 10
save 60 10000

# ==================== NETWORK OPTIMIZATION ====================
# Bind to all interfaces for distributed architecture
bind 0.0.0.0
protected-mode no
port 6379

# TCP backlog for high connection load
tcp-backlog 511
timeout 0
tcp-keepalive 300

# ==================== PERFORMANCE TUNING ====================
# Disable slow operations logging (can be enabled for debugging)
slowlog-log-slower-than 10000
slowlog-max-len 128

# Enable lazy freeing for better performance
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes
replica-lazy-flush yes

# ==================== VECTOR-SPECIFIC OPTIMIZATIONS ====================
# Large client output buffer for vector queries
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Hash optimization for metadata storage
hash-max-listpack-entries 512
hash-max-listpack-value 64

# List optimization for batch operations
list-max-listpack-size -2
list-compress-depth 0

# ==================== SECURITY ====================
# Require password for production
# requirepass your_secure_password_here

# ==================== LOGGING ====================
loglevel notice
logfile "/var/log/redis/redis-server.log"

# ==================== DATABASE CONFIGURATION ====================
databases 16
