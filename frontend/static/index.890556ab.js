import{b as p,j as o,a as d,B as w,e as h,p as C,z as _,E as R,F as z,H as r,J as T}from"./vendor.536e8ebf.js";const b=p(o.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward"),M=p(o.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M17 13l-5 5-5-5h3V9h4v4z"}),"CloudDownload"),P=p(o.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload"),H=p(o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete"),A=()=>{const[m,y]=d.useState([]),[a,x]=d.useState(""),[v,j]=d.useState(!1),[i,U]=d.useState("name"),[l,g]=d.useState("asc");d.useEffect(()=>{u(a)},[a]);const u=async e=>{j(!0);try{const t=await fetch(`/api/files?path=${encodeURIComponent(e)}`),n=await t.json();t.ok?y(n.files||[]):console.error("Error fetching files:",n.message)}catch(t){console.error("Error fetching files:",t)}finally{j(!1)}},E=()=>{const e=a.split("/").slice(0,-1).join("/");x(e)},F=e=>{x(e)},f=e=>{i===e?g(l==="asc"?"desc":"asc"):(U(e),g("asc"))},I=[...m].sort((e,t)=>i==="name"?l==="asc"?e.name.localeCompare(t.name):t.name.localeCompare(e.name):i==="size"?l==="asc"?(e.size||0)-(t.size||0):(t.size||0)-(e.size||0):i==="date"?l==="asc"?e.last_modified-t.last_modified:t.last_modified-e.last_modified:0),S=e=>e==null?"—":e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",B=e=>e?new Date(e*1e3).toLocaleString():"—",k=async e=>{try{const t=await fetch(`/api/download?path=${encodeURIComponent(e.path)}`);if(t.ok){const n=await t.blob(),c=window.URL.createObjectURL(n),s=document.createElement("a");s.href=c,s.download=e.name,document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(c)}else console.error("Error downloading file")}catch(t){console.error("Error downloading file:",t)}},D=async e=>{if(window.confirm(`Are you sure you want to delete ${e.name}?`))try{(await fetch(`/api/delete_file?path=${encodeURIComponent(e.path)}`,{method:"DELETE"})).ok?u(a):console.error("Error deleting file")}catch(t){console.error("Error deleting file:",t)}},L=async e=>{const t=e.target,n=t.files;if(n.length>0){const c=new FormData;for(let s=0;s<n.length;s++)c.append("file",n[s]);c.append("file_type","generic");try{(await fetch(`/api/uploadfile/?path=${encodeURIComponent(a)}`,{method:"POST",body:c})).ok?u(a):console.error("Error uploading files")}catch(s){console.error("Error uploading files:",s)}t.value=""}};return o.jsxs(w,{sx:{p:3},children:[o.jsx(h,{variant:"h5",gutterBottom:!0,children:"File Browser"}),o.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[o.jsx(C,{variant:"outlined",onClick:E,startIcon:o.jsx(b,{}),children:"Up"}),o.jsxs(C,{variant:"contained",component:"label",startIcon:o.jsx(P,{}),children:["Upload Files",o.jsx("input",{type:"file",multiple:!0,hidden:!0,onChange:L})]})]}),o.jsxs(h,{variant:"body1",gutterBottom:!0,children:["Current Path: ",a||"/"]}),v?o.jsx(h,{variant:"body1",children:"Loading..."}):m.length===0?o.jsx(h,{variant:"body1",children:"No files found"}):o.jsxs(_,{children:[o.jsx(R,{children:o.jsxs(z,{children:[o.jsxs(r,{onClick:()=>f("name"),sx:{cursor:"pointer"},children:["Name ",i==="name"&&(l==="asc"?"↑":"↓")]}),o.jsxs(r,{onClick:()=>f("size"),sx:{cursor:"pointer"},children:["Size ",i==="size"&&(l==="asc"?"↑":"↓")]}),o.jsxs(r,{onClick:()=>f("date"),sx:{cursor:"pointer"},children:["Modified ",i==="date"&&(l==="asc"?"↑":"↓")]}),o.jsx(r,{children:"Actions"})]})}),o.jsx(T,{children:I.map(e=>o.jsxs(z,{onClick:()=>e.is_dir&&F(e.path),sx:{cursor:e.is_dir?"pointer":"default"},children:[o.jsx(r,{children:e.name}),o.jsx(r,{children:e.is_dir?"—":S(e.size)}),o.jsx(r,{children:B(e.last_modified)}),o.jsx(r,{children:!e.is_dir&&o.jsxs(o.Fragment,{children:[o.jsx(IconButton,{size:"small",onClick:t=>{t.stopPropagation(),k(e)},sx:{mr:1},children:o.jsx(M,{fontSize:"small"})}),o.jsx(IconButton,{size:"small",color:"error",onClick:t=>{t.stopPropagation(),D(e)},children:o.jsx(H,{fontSize:"small"})})]})})]},e.path))})]})]})};export{A as default};
//# sourceMappingURL=index.890556ab.js.map
