metadata:
  name: "Digital Evidence Handling Procedures"
  category: forensics
  complexity: high
  estimated_time: "Varies by case"
  version: "1.0.0"
  description: "Standard operating procedures for handling digital evidence in forensic investigations"

objective: "Ensure digital evidence integrity, maintain chain of custody, and follow forensic best practices"

legal_framework:
  - "Federal Rules of Evidence (US)"
  - "ISO/IEC 27037:2012 - Digital evidence guidelines"
  - "ACPO Guidelines for Computer-Based Evidence"
  - "Local jurisdictional requirements"
  - "Organizational security policies"

chain_of_custody_requirements:
  documentation_fields:
    - "Case number and incident ID"
    - "Evidence description and serial numbers"
    - "Date and time of collection"
    - "Collector name and credentials"
    - "Location of evidence collection"
    - "Storage location and conditions"
    - "Access log with signatures"
    - "Transfer documentation"

  mandatory_procedures:
    - "Photograph evidence before handling"
    - "Use tamper-evident seals"
    - "Maintain continuous custody log"
    - "Store in secure, climate-controlled facility"
    - "Limit access to authorized personnel only"
    - "Document any access or examination"

evidence_categories:
  volatile_evidence:
    description: "Data that exists temporarily and may be lost"
    examples:
      - "System memory (RAM)"
      - "Network connections"
      - "Running processes"
      - "Cached data"
      - "Temporary files"
    collection_priority: "Highest - collect immediately"
    preservation_methods:
      - "Memory dumps using lime or winpmem"
      - "Live system imaging"
      - "Network packet capture"
      - "Process memory capture"

  persistent_evidence:
    description: "Data stored on non-volatile media"
    examples:
      - "Hard disk drives"
      - "Solid state drives"
      - "USB drives"
      - "Network attached storage"
      - "Cloud storage"
    collection_priority: "High - image before analysis"
    preservation_methods:
      - "Bit-for-bit disk imaging"
      - "Write-blocking hardware"
      - "Cryptographic hashing"
      - "Multiple copies creation"

  network_evidence:
    description: "Data transmitted over network connections"
    examples:
      - "Network packet captures"
      - "Firewall logs"
      - "Router configurations"
      - "DNS queries"
      - "Email communications"
    collection_priority: "Time-sensitive - capture ongoing"
    preservation_methods:
      - "Continuous packet capture"
      - "Log file preservation"
      - "Network device imaging"
      - "Traffic flow analysis"

collection_procedures:
  preparation_phase:
    equipment_checklist:
      - "Forensic workstation with write-blockers"
      - "Sterile storage media (larger than evidence)"
      - "Digital camera for documentation"
      - "Chain of custody forms"
      - "Evidence bags and tamper seals"
      - "Portable forensic tools"
      - "Network cables and adapters"

    documentation_setup:
      - "Prepare case folder and numbering system"
      - "Initialize chain of custody log"
      - "Set up secure evidence storage area"
      - "Verify tool functionality and licensing"
      - "Coordinate with legal and management"

  acquisition_phase:
    live_system_procedures:
      steps:
        - "Document system state before interaction"
        - "Capture volatile data first (memory, processes)"
        - "Use minimal interaction to preserve evidence"
        - "Image system without modification"
        - "Verify image integrity with hashes"
      commands:
        - "date; uptime; w > system_state.txt"
        - "ps auxf > running_processes.txt"
        - "netstat -an > network_connections.txt"
        - "mount > mounted_filesystems.txt"
        - "dd if=/dev/sda of=/mnt/evidence/system.dd bs=4M conv=noerror,sync"

    powered_off_system_procedures:
      steps:
        - "Photograph system and connections"
        - "Document hardware configuration"
        - "Remove storage devices safely"
        - "Image using write-blocking hardware"
        - "Calculate and verify hash values"
      safety_measures:
        - "Use anti-static precautions"
        - "Maintain photographic record"
        - "Label all cables and components"
        - "Store original media separately"

imaging_standards:
  preferred_formats:
    - "Raw (dd) images for Unix/Linux systems"
    - "E01 (Expert Witness) format for Windows systems"
    - "AFF (Advanced Forensic Format) for large drives"
    - "VMDK for virtual machine evidence"

  hash_algorithms:
    required:
      - "MD5 for basic integrity verification"
      - "SHA-256 for cryptographic verification"
    optional:
      - "SHA-1 for legacy compatibility"
      - "SHA-512 for enhanced security"

  verification_procedures:
    - "Calculate hash before imaging"
    - "Calculate hash after imaging"
    - "Compare source and image hashes"
    - "Document any discrepancies immediately"
    - "Re-image if integrity verification fails"

storage_requirements:
  physical_security:
    - "Locked, access-controlled evidence room"
    - "Climate control (temperature and humidity)"
    - "Fire suppression systems"
    - "Security cameras monitoring access"
    - "Visitor log and escort requirements"

  digital_security:
    - "Encrypted storage for sensitive data"
    - "Regular backup of evidence images"
    - "Access logging and audit trails"
    - "Network isolation for analysis systems"
    - "Malware scanning before analysis"

  retention_policies:
    - "Retain original evidence until case closure"
    - "Maintain working copies for analysis"
    - "Follow legal retention requirements"
    - "Secure destruction after retention period"
    - "Document all disposal activities"

analysis_protocols:
  working_copy_creation:
    procedure:
      - "Never analyze original evidence directly"
      - "Create working copies from forensic images"
      - "Verify working copy integrity"
      - "Document creation process"
      - "Use write-protection during analysis"
    commands:
      - "cp original_image.dd working_copy.dd"
      - "md5sum original_image.dd working_copy.dd"
      - "mount -o ro,loop working_copy.dd /mnt/analysis"

  examination_methodology:
    systematic_approach:
      - "Define examination objectives"
      - "Use validated forensic tools"
      - "Document all procedures and findings"
      - "Maintain detailed examination logs"
      - "Preserve exculpatory evidence"

    tool_validation:
      - "Use NIST-tested forensic tools when possible"
      - "Document tool versions and configurations"
      - "Perform tool validation tests"
      - "Maintain tool calibration records"

quality_assurance:
  peer_review_process:
    - "Independent verification of critical findings"
    - "Review of examination methodology"
    - "Validation of technical procedures"
    - "Cross-examination of conclusions"

  documentation_standards:
    - "Detailed case notes with timestamps"
    - "Screenshots and photographs of evidence"
    - "Complete tool output preservation"
    - "Clear explanation of technical procedures"
    - "Summary of findings and conclusions"

common_mistakes:
  collection_errors:
    - issue: "Modifying evidence during collection"
      prevention: "Use write-blocking hardware and read-only mounts"
    - issue: "Incomplete chain of custody documentation"
      prevention: "Use standardized forms and procedures"
    - issue: "Improper evidence storage"
      prevention: "Follow environmental and security requirements"

  analysis_errors:
    - issue: "Working on original evidence"
      prevention: "Always use verified working copies"
    - issue: "Inadequate documentation"
      prevention: "Document every step and finding"
    - issue: "Tool malfunction or misconfiguration"
      prevention: "Regular tool testing and validation"

reporting_standards:
  technical_report_components:
    - "Executive summary of findings"
    - "Detailed methodology description"
    - "Evidence inventory and chain of custody"
    - "Technical analysis results"
    - "Conclusions and recommendations"
    - "Appendices with supporting data"

  expert_testimony_preparation:
    - "Review all case materials thoroughly"
    - "Prepare clear explanations of technical concepts"
    - "Anticipate cross-examination questions"
    - "Maintain professional objectivity"
    - "Support conclusions with documented evidence"

compliance_requirements:
  regulatory_frameworks:
    - "HIPAA for healthcare-related evidence"
    - "SOX for financial institution evidence"
    - "GDPR for EU personal data"
    - "Industry-specific regulations"

  audit_procedures:
    - "Regular compliance assessments"
    - "External certification maintenance"
    - "Staff training and qualification"
    - "Procedure updates and improvements"

emergency_procedures:
  evidence_compromise:
    immediate_actions:
      - "Isolate compromised evidence immediately"
      - "Document compromise circumstances"
      - "Notify case stakeholders"
      - "Assess impact on investigation"
      - "Implement corrective measures"

  security_incidents:
    response_protocol:
      - "Activate incident response team"
      - "Secure evidence storage areas"
      - "Review access logs"
      - "Implement additional security measures"
      - "Conduct security assessment"

training_requirements:
  mandatory_certifications:
    - "Digital forensics fundamentals"
    - "Chain of custody procedures"
    - "Legal requirements and testimony"
    - "Tool-specific training"

  continuing_education:
    - "Annual recertification requirements"
    - "New technology and technique training"
    - "Legal and regulatory updates"
    - "Professional conference attendance"

success_metrics:
  case_outcomes:
    - "Evidence admissibility in legal proceedings"
    - "Successful prosecution or resolution"
    - "No evidence integrity challenges"
    - "Timely delivery of analysis results"

  operational_metrics:
    - "Zero chain of custody breaks"
    - "100% evidence integrity verification"
    - "Compliance audit pass rates"
    - "Staff certification maintenance"
