<\!DOCTYPE html>
<html>
<head>
    <title>WebSocket Test</title>
</head>
<body>
    <h1>WebSocket Connection Test</h1>
    <div id="status">Connecting...</div>
    <div id="messages"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const messagesDiv = document.getElementById('messages');
        
        function log(message) {
            const p = document.createElement('p');
            p.textContent = new Date().toLocaleTimeString() + ': ' + message;
            messagesDiv.appendChild(p);
            console.log(message);
        }
        
        // Test Vite proxy WebSocket (what frontend should use)
        log('Testing WebSocket via Vite proxy: ws://localhost:5173/ws');
        const ws1 = new WebSocket('ws://localhost:5173/ws');
        
        ws1.onopen = function() {
            log('‚úÖ Vite proxy WebSocket connected');
            statusDiv.textContent = 'Connected via Vite proxy';
        };
        
        ws1.onerror = function(error) {
            log('‚ùå Vite proxy WebSocket error: ' + error);
        };
        
        ws1.onclose = function(event) {
            log('üîå Vite proxy WebSocket closed: ' + event.code + ' - ' + event.reason);
            
            // Test direct connection as fallback
            setTimeout(() => {
                log('Testing direct WebSocket: ws://localhost:8001/ws');
                const ws2 = new WebSocket('ws://localhost:8001/ws');
                
                ws2.onopen = function() {
                    log('‚úÖ Direct WebSocket connected');
                    statusDiv.textContent = 'Connected directly';
                };
                
                ws2.onerror = function(error) {
                    log('‚ùå Direct WebSocket error: ' + error);
                    statusDiv.textContent = 'All connections failed';
                };
                
                ws2.onclose = function(event) {
                    log('üîå Direct WebSocket closed: ' + event.code + ' - ' + event.reason);
                };
            }, 1000);
        };
    </script>
</body>
</html>
