metadata:
  category: network
  description: Network analysis, scanning, and security tools
  last_updated: "2024-01-01T00:00:00"
  version: "1.0.0"

tools:
  - name: nmap
    type: network_scanner
    purpose: Network discovery and security auditing tool
    installation:
      apt: sudo apt-get install nmap
      yum: sudo yum install nmap
      pacman: sudo pacman -S nmap
      brew: brew install nmap
    usage:
      basic_scan: nmap {target}
      port_scan: nmap -p {ports} {target}
      service_scan: nmap -sV {target}
      os_detection: nmap -O {target}
      stealth_scan: nmap -sS {target}
      aggressive_scan: nmap -A {target}
    common_examples:
      - description: Basic host discovery scan
        command: nmap 192.168.1.0/24
        expected_output: "List of active hosts with open ports"
      - description: Comprehensive scan with service detection
        command: nmap -sV -sC -O target.com
        expected_output: "Detailed service versions and OS information"
      - description: Fast scan of common ports
        command: nmap -F 192.168.1.100
        expected_output: "Quick scan of top 100 most common ports"
      - description: UDP port scan (requires sudo)
        command: sudo nmap -sU 192.168.1.100
        expected_output: "Open UDP ports and services"
      - description: Script scan for vulnerabilities
        command: nmap --script vuln 192.168.1.100
        expected_output: "Known vulnerabilities and security issues"
    troubleshooting:
      - problem: "Host seems down - no response"
        solution: "Try -Pn flag to skip ping test, or check firewall settings"
      - problem: "Permission denied for certain scan types"
        solution: "Use sudo for raw socket operations (SYN scan, OS detection)"
      - problem: "Scan taking too long"
        solution: "Use -T4 for faster timing, or -F for top ports only"
    security_notes:
      - "Unauthorized scanning may violate laws and network policies"
      - "Use stealth options (-sS) to avoid detection"
      - "Consider rate limiting with -T options to avoid overwhelming targets"
      - "Always get permission before scanning networks you don't own"
    related_tools: ["masscan", "zmap", "rustscan", "angry-ip-scanner"]
    output_formats:
      - "Standard text output with host and port information"
      - "XML output with -oX for parsing"
      - "Greppable output with -oG for filtering"
    performance_notes:
      - "Use timing templates (-T0 to -T5) to balance speed and stealth"
      - "Parallel scanning can be adjusted with --min-parallelism"
      - "Large network scans may take hours or days"

  - name: netcat
    type: network_utility
    purpose: Network debugging and data transfer utility (network Swiss Army knife)
    installation:
      apt: sudo apt-get install netcat-openbsd
      yum: sudo yum install nc
      pacman: sudo pacman -S openbsd-netcat
      brew: brew install netcat
    usage:
      listen_port: nc -l -p {port}
      connect: nc {host} {port}
      file_transfer: nc -l -p {port} > received_file
      port_scan: nc -z {host} {port_range}
      banner_grab: nc {host} {port}
    common_examples:
      - description: Listen on port for incoming connections
        command: nc -l -p 4444
        expected_output: "Waits for connections on port 4444"
      - description: Connect to remote host and port
        command: nc example.com 80
        expected_output: "Connects to web server, allows manual HTTP requests"
      - description: Transfer file to remote host
        command: nc -l -p 1234 < file.txt
        expected_output: "Serves file.txt to anyone connecting to port 1234"
      - description: Simple port scanning
        command: nc -z -v 192.168.1.100 20-80
        expected_output: "Tests connectivity to ports 20-80"
      - description: Create simple backdoor (for authorized testing)
        command: nc -l -p 4444 -e /bin/bash
        expected_output: "WARNING: Provides shell access - use only in authorized tests"
    troubleshooting:
      - problem: "Address already in use"
        solution: "Port is busy, try different port or kill process using the port"
      - problem: "Connection refused"
        solution: "Check if target port is open and host is reachable"
      - problem: "nc command not found"
        solution: "Install netcat package, may be called 'nc', 'netcat', or 'ncat'"
    security_notes:
      - "Netcat can be used for both legitimate and malicious purposes"
      - "Be extremely careful with -e flag - provides shell access"
      - "Monitor network traffic when using netcat"
      - "Use only for authorized penetration testing"
    related_tools: ["socat", "ncat", "telnet", "openssl s_client"]

  - name: wireshark
    type: packet_analyzer
    purpose: Network protocol analyzer and packet capture tool
    installation:
      apt: sudo apt-get install wireshark
      yum: sudo yum install wireshark
      pacman: sudo pacman -S wireshark-qt
      brew: brew install --cask wireshark
    usage:
      capture_interface: wireshark -i {interface}
      read_pcap: wireshark {pcap_file}
      command_line: tshark -i {interface}
      filter_capture: tshark -f "{capture_filter}" -i {interface}
    common_examples:
      - description: Capture packets on network interface
        command: sudo wireshark -i eth0
        expected_output: "Opens GUI with live packet capture"
      - description: Command-line packet capture
        command: sudo tshark -i wlan0 -w capture.pcap
        expected_output: "Saves packets to capture.pcap file"
      - description: Filter HTTP traffic only
        command: tshark -f "port 80" -i eth0
        expected_output: "Shows only HTTP traffic packets"
      - description: Analyze existing pcap file
        command: wireshark suspicious_traffic.pcap
        expected_output: "Opens pcap file for analysis in GUI"
    troubleshooting:
      - problem: "Permission denied when capturing"
        solution: "Add user to wireshark group or run with sudo"
      - problem: "No interfaces available"
        solution: "Check interface names with 'ip link' or run as root"
      - problem: "Capture file format not supported"
        solution: "Convert with editcap or use different capture tool"
    security_notes:
      - "Capturing packets may reveal sensitive information"
      - "Ensure compliance with privacy laws and policies"
      - "Encrypt and secure captured data files"
      - "Use appropriate filters to minimize data collection"
    related_tools: ["tcpdump", "tshark", "ettercap", "tcpflow"]

  - name: tcpdump
    type: packet_capture
    purpose: Command-line packet analyzer and network monitoring tool
    installation:
      apt: sudo apt-get install tcpdump
      yum: sudo yum install tcpdump
      pacman: sudo pacman -S tcpdump
      brew: brew install tcpdump
    usage:
      basic_capture: tcpdump -i {interface}
      save_to_file: tcpdump -i {interface} -w {file.pcap}
      filter_traffic: tcpdump -i {interface} {filter}
      read_file: tcpdump -r {file.pcap}
    common_examples:
      - description: Monitor all traffic on interface
        command: sudo tcpdump -i eth0
        expected_output: "Real-time packet display with headers"
      - description: Capture HTTP traffic to file
        command: sudo tcpdump -i any port 80 -w http_capture.pcap
        expected_output: "Saves HTTP packets to pcap file"
      - description: Monitor DNS queries
        command: sudo tcpdump -i any port 53
        expected_output: "Shows DNS resolution requests and responses"
      - description: Capture packets from specific host
        command: sudo tcpdump host 192.168.1.100
        expected_output: "Shows traffic to/from specified IP address"
    troubleshooting:
      - problem: "tcpdump: permission denied"
        solution: "Run with sudo or add user to appropriate groups"
      - problem: "No suitable device found"
        solution: "List interfaces with 'tcpdump -D' and specify correct one"
      - problem: "Capture file too large"
        solution: "Use -C option to rotate files or -c to limit packet count"
    related_tools: ["wireshark", "tshark", "ngrep", "iftop"]

  - name: iftop
    type: network_monitor
    purpose: Real-time network bandwidth monitoring tool
    installation:
      apt: sudo apt-get install iftop
      yum: sudo yum install iftop
      pacman: sudo pacman -S iftop
      brew: brew install iftop
    usage:
      monitor_interface: iftop -i {interface}
      text_mode: iftop -t -s 10
      filter_host: iftop -f "{filter}"
    common_examples:
      - description: Monitor bandwidth usage on ethernet
        command: sudo iftop -i eth0
        expected_output: "Real-time bandwidth usage by connection"
      - description: Text output for 10 seconds
        command: sudo iftop -t -s 10 -i wlan0
        expected_output: "Text summary of network usage for 10 seconds"
      - description: Monitor specific subnet only
        command: sudo iftop -f "net 192.168.1.0/24"
        expected_output: "Shows traffic only for specified network range"
    troubleshooting:
      - problem: "Couldn't listen on interface"
        solution: "Check interface exists and run with sudo privileges"
      - problem: "Display too cluttered"
        solution: "Use filters to focus on specific traffic or hosts"
    related_tools: ["nethogs", "vnstat", "bmon", "nload"]
